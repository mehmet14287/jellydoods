(function(a,D){a.SystemTypeEnum={WebBrowser:0,WindowsPhone:1,Android:2,iOS:3};a.AssetResolutionEnum={ResolutionA:0,ResolutionB:1,ResolutionC:2,ResolutionD:3,ResolutionE:4,ResolutionDev:5};a.LayoutOrientationEnum={Landscape:0,Portrait:1};a.DirectionEnum={None:0,Right:1,Left:2,Top:3,Bottom:4};a.EffectTypeEnum={None:0,NumberEffect:1,SparkEffect:2};a.CellTypeEnum={None:0};a.ObjectTypeEnum={None:0,Block:1,Green:2,Red:3,Yellow:4,Purple:5,Letter1:6,Letter2:7,Letter3:8,Letter4:9,Letter5:10,Level:11};a.GameStateEnum=
{GamePreLoading:1,GameLoading:2,GameRun:3};a.ButtonTypeEnum={None:0,Reset:1,Hint:2,Undo:3,Menu:4,Ok:5,Retry:6,Home:7,Levels:8,Pack:9}})(window.OkijinGame=window.OkijinGame||{});(function(a,D){a.systemType=a.SystemTypeEnum.WebBrowser;a.preloadSounds=!1;a.devMode=!1;a.isDemo=!1;a.isSoundEnabled=!0;a.shopAvailable=!1;a.resetUserData=!1;a.userData={};a.canShare=!0;a.language=["default","en"];a.soundItems={undo:"assets/sound/undo.mp3",click:"assets/sound/click.mp3",touch:"assets/sound/touch.mp3",slide:"assets/sound/slide.mp3",locked:"assets/sound/locked.mp3",score:"assets/sound/score.mp3",badclick:"assets/sound/badclick.mp3",fail:"assets/sound/fail.mp3",win:"assets/sound/win.mp3",
alert:"assets/sound/alert.mp3",tip:"assets/sound/tip.mp3",slash:"assets/sound/slash.mp3"};a.shopItems=[];a.leaderBoardItems=[];a.initializeSystem=function(){"undefined"!==typeof window.external&&"undefined"!==typeof window.external.notify&&(a.systemType=a.SystemTypeEnum.WindowsPhone);switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:a.preloadSounds=!1;break;case a.SystemTypeEnum.WebBrowser:a.preloadSounds=!0}};a.loadUserData=function(d){if(d===D)switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandLoadUserData");
break;case a.SystemTypeEnum.WebBrowser:window.localStorage?(d=a.resetUserData?'{ "lang": 0, "gold": 0, "soundEnabled": 1, "levels": [], "packIndex": 0, "levelIndex": 0, "moveTip": 0 }':window.localStorage.getItem("OkijinGame_gyetnp"))&&""!==d||(d='{ "lang": 0, "gold": 0, "soundEnabled": 1, "levels": [], "packIndex": 0, "levelIndex": 0, "moveTip": 0 }'):d='{ "lang": 0, "gold": 0, "soundEnabled": 1, "levels": [], "packIndex": 0, "levelIndex": 0, "moveTip": 0 }',a.loadUserData(d)}else a.userData=JSON.parse(d),
a.isSoundEnabled=1===a.userData.soundEnabled?!0:!1,0===a.userData.levels.length&&(a.userData.levels[0]={unlocked:1,stars:0,hint:0,reward:0}),a.saveUserData()};a.saveUserData=function(){switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandSaveUserData:"+JSON.stringify(a.userData));break;case a.SystemTypeEnum.WebBrowser:window.localStorage.setItem("OkijinGame_gyetnp",JSON.stringify(a.userData))}};a.enableSound=function(d){a.isSoundEnabled=d;a.userData.soundEnabled=
d?1:0;d?a.playSound("music1"):a.stopSound("music1");a.saveUserData()};a.playSound=function(d){if(!1!==a.isSoundEnabled)switch(a.systemType){case a.SystemTypeEnum.WebBrowser:"music1"===d?AudioManager.loopSound(d):AudioManager.playSound(d)}};a.stopSound=function(d){switch(a.systemType){case a.SystemTypeEnum.WindowsPhone:window.external.notify("commandStopSound:"+d);break;case a.SystemTypeEnum.WebBrowser:AudioManager.stopSound(d)}};a.stopAllSounds=function(){for(var d in a.soundItems)a.soundItems.hasOwnProperty(d)&&
a.stopSound(d)}})(window.OkijinGame=window.OkijinGame||{});(function(a,D){a.levels=[];a.initializeLevels=function(){a.loadLevelPack1();a.loadLevelPack2()};a.loadLevelPack1=function(){for(var d=[{moves:[5,10],stars:[25,50,95],objects:[[0,2,2,0,0,0,0,3],[0,0,2,0,0,2,2,2],[0,0,0,0,0,0,0,3],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],hint:[[0,2,2,0,0,0,0,0],[0,0,2,2,2,2,0,3],[0,0,0,0,0,0,0,3],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[5,10],stars:[25,50,95],
objects:[[0,0,0,2,2,2,2,3],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,2,0,0,0],[0,0,0,0,2,0,0,3]],hint:[[0,0,0,2,2,2,2,3],[0,0,0,0,0,0,2,3],[0,0,0,0,0,0,2,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[5,10],stars:[25,50,95],objects:[[3,3,3,3,3,0,0,4],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[4,4,0,0,0,0,0,0],[4,1,4,1,0,0,3,0]],hint:[[3,3,
3,3,3,3,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[4,4,4,0,0,0,0,0],[4,1,4,1,0,0,0,0]]},{moves:[5,10],stars:[25,50,95],objects:[[0,1,4,4,4,4,1,0],[0,1,4,0,0,0,1,0],[0,1,0,0,0,1,1,0],[4,0,0,0,0,0,0,4],[0,0,0,0,0,0,0,0],[0,2,0,0,0,0,0,0],[0,0,1,2,1,0,0,0],[0,2,2,2,0,0,0,0]],hint:[[0,0,4,4,4,4,0,0],[0,0,4,0,0,0,0,0],[0,0,4,4,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,2,0,2,0,0,0,0],[0,2,2,2,0,0,0,0]]},{moves:[6,10],stars:[25,
50,95],objects:[[0,1,3,3,3,1,0,0],[0,1,3,1,3,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[3,0,0,0,0,0,0,0],[3,0,0,0,0,0,0,3]],hint:[[0,0,3,3,3,0,3,0],[0,0,3,0,3,3,3,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[4,5],stars:[50,75,95],objects:[[0,0,0,0,2,1,0,0],[1,0,0,0,2,0,0,0],[2,0,0,0,0,0,0,0],[0,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,2],[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,2,1,0,0,1]],hint:[[0,
0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,2,2,0,0,0],[0,0,0,0,2,0,0,0],[0,0,0,2,2,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[5,10],stars:[25,50,95],objects:[[5,5,5,0,0,0,0,0],[0,0,0,0,0,0,0,1],[0,0,0,0,0,3,3,3],[0,0,0,1,5,1,0,3],[0,0,0,5,5,5,0,0],[3,0,0,1,5,1,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,5,5]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,3,0],[0,0,0,0,0,3,3,3],[0,0,0,0,5,0,0,3],[0,0,0,5,5,5,0,0],[0,0,0,0,5,0,0,0],[0,0,0,5,5,5,5,5],[0,0,0,0,0,0,0,0]]},{moves:[6,10],stars:[25,
50,95],objects:[[4,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0],[2,1,1,0,0,0,0,0],[2,2,0,0,0,0,0,0],[2,1,1,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,4,4,4,0],[0,0,0,0,0,1,2,0]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,4,0,0],[2,0,0,0,0,4,4,4],[2,2,2,0,0,0,0,0],[2,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[4,5],stars:[50,75,95],objects:[[0,0,0,0,0,0,1,4],[0,0,0,4,0,0,4,0],[1,4,0,0,0,4,1,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0],[0,0,0,1,0,0,0,0],[0,0,0,0,4,0,0,0]],hint:[[0,
0,0,0,0,4,0,4],[0,0,0,0,4,4,4,4],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[5,10],stars:[25,50,95],objects:[[2,2,1,0,1,0,0,0],[2,1,0,0,0,0,0,4],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,1,0],[2,0,0,0,0,0,0,4],[0,0,1,1,0,1,4,4]],hint:[[2,2,1,0,1,0,0,0],[2,1,0,0,0,0,0,0],[2,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,1,4],[0,0,0,0,0,0,0,4],[0,0,1,1,0,1,4,4]]},{moves:[8,10],stars:[25,
50,95],objects:[[0,0,0,1,1,1,0,0],[0,0,0,4,4,1,0,0],[0,0,0,1,4,1,5,0],[0,0,0,1,4,4,0,0],[0,0,0,1,1,1,0,0],[0,0,0,0,4,0,0,4],[1,1,0,0,0,0,0,0],[5,5,0,0,0,0,0,0]],hint:[[0,0,4,1,1,1,0,0],[0,0,4,4,4,1,0,0],[0,0,0,1,4,1,0,0],[0,0,0,1,4,4,0,0],[0,0,0,1,1,1,0,0],[0,0,0,0,0,0,0,0],[1,1,0,0,0,0,0,0],[5,5,5,0,0,0,0,0]]},{moves:[5,10],stars:[25,50,95],objects:[[1,1,0,0,0,1,1,1],[1,1,0,0,0,1,1,1],[4,5,0,0,0,0,0,1],[4,0,0,0,0,0,0,5],[4,0,0,0,0,0,0,5],[4,0,0,0,0,0,0,1],[4,0,0,0,0,0,0,1],[1,1,4,4,4,1,1,1]],hint:[[1,
1,0,0,0,1,1,1],[1,1,0,0,0,1,1,1],[0,0,0,0,4,5,5,1],[0,0,0,0,4,5,0,0],[0,0,0,0,4,0,0,0],[0,0,0,0,4,0,0,1],[0,0,0,0,4,0,0,1],[1,1,4,4,4,1,1,1]]},{moves:[6,10],stars:[50,75,95],objects:[[0,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0],[2,0,5,2,3,0,0,0],[1,0,2,1,3,0,0,1],[0,0,5,3,5,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,1,0,0,0,0]],hint:[[0,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0],[2,2,0,0,0,0,0,0],[1,2,5,1,0,0,0,1],[0,0,5,5,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,3,3,0,0,0],[0,0,0,1,3,0,0,0]]},{moves:[4,5],stars:[50,
75,95],objects:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,3,3,0,1,3,0],[1,3,0,0,0,0,0,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[3,0,0,0,0,0,0,3],[0,0,0,3,0,0,0,0]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,3,0],[0,0,0,0,0,0,3,0],[0,0,0,0,0,3,3,3],[0,0,0,0,0,0,0,3],[0,0,0,0,0,0,0,3],[0,0,0,0,0,0,0,0]]},{moves:[4,5],stars:[50,75,95],objects:[[0,0,0,0,5,1,0,5],[1,0,5,0,0,0,0,1],[0,0,0,0,0,0,5,5],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[5,0,0,0,0,1,0,0]],hint:[[0,
0,0,0,5,0,5,5],[0,0,0,0,5,5,5,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[4,5],stars:[50,75,95],objects:[[0,0,3,0,0,0,0,0],[0,0,0,0,0,0,0,4],[3,3,0,4,0,0,0,0],[0,1,0,0,0,0,0,4],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,4,0,0,0,0],[0,0,4,4,0,0,0,0]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,4],[3,3,3,0,0,0,0,4],[0,0,0,0,0,0,4,4],[0,0,0,0,0,0,4,4],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[5,5],stars:[50,
75,95],objects:[[2,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0],[1,1,0,0,2,0,1,2],[2,0,0,0,0,5,2,0],[0,0,0,0,0,5,0,0],[0,0,0,0,0,5,0,0],[0,0,0,0,0,5,0,0],[0,0,0,0,0,0,0,0]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,2,0,2],[0,0,0,0,0,2,2,2],[0,0,0,0,0,5,0,0],[0,0,0,0,0,5,0,0],[0,0,0,0,0,5,0,0],[0,0,0,0,0,5,0,0]]},{moves:[5,5],stars:[50,75,95],objects:[[0,0,0,0,0,1,1,0],[0,0,3,3,3,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,3,3],[0,0,0,0,0,0,2,1],[0,0,0,0,0,0,0,0],[2,2,0,0,0,0,0,0],[3,0,0,0,0,0,0,0]],hint:[[0,
0,0,0,0,1,1,0],[3,3,3,0,0,0,0,0],[3,0,0,0,0,0,0,0],[3,3,0,0,0,0,0,0],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,2,0],[0,0,0,0,0,0,2,2],[0,0,0,0,0,0,0,0]]},{moves:[10,15],stars:[50,75,95],objects:[[0,0,0,3,2,0,0,0],[1,0,1,0,0,0,0,1],[0,0,0,0,0,0,0,0],[0,1,3,0,0,2,1,0],[0,1,1,0,0,1,1,0],[3,0,0,0,0,0,0,2],[1,0,0,0,1,0,0,1],[0,0,0,0,0,0,0,0]],hint:[[0,0,0,0,0,0,0,0],[1,0,1,0,0,0,0,1],[0,0,3,3,2,2,0,0],[0,1,3,0,0,2,1,0],[0,1,1,0,0,1,1,0],[0,0,0,0,0,0,0,0],[1,0,0,0,1,0,0,1],[0,0,0,0,0,0,0,0]]},{moves:[7,10],stars:[50,
75,95],objects:[[0,0,0,0,0,0,5,0],[1,0,1,1,1,1,0,1],[0,5,0,0,0,0,0,0],[1,0,1,1,1,1,0,1],[0,5,0,0,5,0,0,5],[1,0,1,1,1,1,0,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],hint:[[0,0,0,0,0,0,0,0],[1,0,1,1,1,1,0,1],[0,0,0,0,0,0,0,0],[1,0,1,1,1,1,0,1],[5,5,0,0,0,0,0,0],[1,5,1,1,1,1,0,1],[5,5,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[8,10],stars:[50,75,95],objects:[[0,0,0,0,0,0,0,3],[0,1,1,0,0,1,1,0],[1,1,3,0,0,5,1,0],[5,0,0,0,0,0,0,3],[5,0,0,0,0,0,0,3],[0,1,3,0,0,5,1,1],[0,1,1,0,0,1,1,0],[5,0,0,0,0,0,0,0]],hint:[[0,
0,0,0,0,0,0,0],[0,1,1,0,0,1,1,0],[1,1,0,0,0,3,1,0],[0,0,0,5,5,3,3,0],[0,0,0,0,5,5,3,3],[0,1,0,0,0,5,1,1],[0,1,1,0,0,1,1,0],[0,0,0,0,0,0,0,0]]},{moves:[9,10],stars:[50,75,95],objects:[[2,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[1,1,0,0,0,0,0,1],[1,0,0,0,0,0,1,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[2,0,0,0,0,0,0,0],[2,0,0,0,0,0,0,2]],hint:[[0,0,0,0,2,2,0,0],[0,0,0,0,2,2,0,0],[1,1,0,0,0,0,0,1],[1,0,0,0,0,0,1,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[8,10],stars:[50,
75,95],objects:[[1,3,3,1,3,0,0,3],[1,0,3,1,0,0,3,1],[1,0,1,3,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,3]],hint:[[1,3,3,1,0,0,0,0],[1,3,3,1,0,0,0,1],[1,3,1,0,0,0,0,0],[3,3,3,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[8,10],stars:[50,75,95],objects:[[5,1,0,0,0,0,1,0],[0,1,0,0,0,0,1,0],[0,1,0,0,0,5,1,0],[0,2,0,0,0,0,4,0],[0,3,2,0,0,0,5,0],[0,1,0,0,0,2,1,0],[0,1,0,0,0,0,1,0],[0,1,0,0,0,0,1,2]],hint:[[0,
1,0,0,0,0,1,0],[0,1,0,0,0,0,1,0],[0,1,0,0,0,5,1,0],[0,0,0,0,0,5,5,4],[3,0,0,0,0,2,2,2],[0,1,0,0,0,2,1,0],[0,1,0,0,0,0,1,0],[0,1,0,0,0,0,1,0]]},{moves:[9,10],stars:[50,75,95],objects:[[0,2,1,1,0,5,0,0],[0,0,0,5,5,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1],[1,0,0,0,0,0,1,5],[0,0,0,0,0,0,0,5],[1,0,0,0,0,1,0,1],[0,5,0,0,0,0,0,0]],hint:[[0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,1,5],[0,0,0,0,5,5,5,5],[1,0,0,0,0,1,5,1],[0,0,0,0,0,0,0,2]]}],e=0;e<d.length;e+=1)a.levels.push(d[e])};
a.loadLevelPack2=function(){for(var d=[{moves:[7,10],stars:[50,90,95],objects:[[4,4,0,0,0,0,0,1],[4,1,0,0,0,0,0,1],[1,0,0,0,0,0,0,0],[1,1,3,0,3,0,0,0],[1,1,1,0,1,3,0,0],[4,0,0,0,0,0,0,0],[1,1,1,0,1,1,4,1],[1,1,1,0,1,1,1,1]],hint:[[4,4,4,0,0,0,0,1],[4,1,4,0,0,0,0,1],[1,0,0,0,0,0,0,0],[1,1,0,0,0,0,0,3],[1,1,1,0,1,0,0,3],[0,0,0,0,0,0,0,3],[1,1,1,0,1,1,0,1],[1,1,1,0,1,1,1,1]]},{moves:[9,10],stars:[50,75,95],objects:[[0,1,4,0,0,0,1,0],[1,2,0,0,0,0,3,1],[0,0,0,0,0,0,0,5],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,
0,0],[3,0,0,0,0,0,0,0],[1,5,0,0,0,0,4,1],[0,1,0,0,0,2,1,0]],hint:[[0,0,2,0,0,0,0,0],[0,0,2,0,0,0,3,0],[0,0,0,0,0,0,3,5],[0,0,0,0,0,0,0,5],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,4,0,0],[0,0,0,0,0,4,0,0]]},{moves:[6,10],stars:[50,75,95],objects:[[0,0,1,0,0,1,0,0],[0,0,1,0,0,1,0,0],[0,0,0,0,0,4,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,4,0,0,4,0,0],[0,0,1,0,0,1,0,0],[4,0,1,0,0,1,0,4]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[4,0,0,0,0,0,0,0],[4,0,0,0,0,0,0,0],[4,0,0,0,0,0,0,0],[4,4,0,0,
0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[8,10],stars:[50,75,95],objects:[[5,2,0,0,0,0,0,0],[3,4,0,0,0,0,0,4],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[5,0,0,0,0,0,0,0],[2,0,0,3,0,0,0,0],[0,0,0,0,0,4,0,0]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[5,0,0,0,0,0,0,0],[5,0,0,0,0,0,0,0],[2,2,0,3,0,0,0,0],[4,4,4,3,0,0,0,0]]},{moves:[10,15],stars:[50,75,95],objects:[[0,0,4,4,4,1,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,3],[1,1,
1,4,4,1,1,1],[3,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,4,4,4,0,0]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,4,4,4,0,0,0],[0,0,0,4,4,0,0,0],[3,3,0,4,4,4,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[12,15],stars:[50,75,95],objects:[[5,0,0,1,1,0,0,5],[1,1,0,0,4,0,1,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,5,0,0,5,0,0],[1,1,1,0,0,1,1,1],[5,0,0,0,0,0,0,5]],hint:[[0,0,5,0,0,5,0,0],[0,0,5,5,5,5,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,4],
[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[10,15],stars:[50,75,95],objects:[[0,0,0,0,0,1,0,0],[0,0,0,0,0,4,0,0],[0,1,1,1,1,1,0,1],[0,0,4,4,0,1,0,0],[0,0,1,4,4,0,0,0],[0,0,1,1,1,1,0,0],[0,0,4,1,4,0,0,0],[0,0,1,1,4,4,0,4]],hint:[[0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0],[0,1,1,1,1,1,0,1],[0,4,4,4,4,1,4,4],[0,0,1,0,4,4,4,4],[0,0,1,1,1,1,0,0],[0,0,0,1,0,0,0,0],[0,0,1,1,0,0,0,0]]},{moves:[12,15],stars:[50,75,95],objects:[[0,1,2,2,0,1,2,2],[1,3,3,1,2,1,2,1],[0,1,3,0,2,0,0,3],[3,1,2,0,0,0,
0,0],[3,2,0,0,0,0,0,0],[1,1,0,0,0,0,0,0],[3,0,0,0,0,0,0,0],[3,0,0,0,0,0,0,0]],hint:[[0,1,0,2,2,1,2,2],[1,3,3,1,2,1,2,1],[0,1,3,0,2,2,2,0],[3,1,3,0,0,0,0,0],[3,3,3,0,0,0,0,0],[1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[13,15],stars:[50,75,95],objects:[[3,0,0,0,0,0,0,4],[0,0,0,0,0,0,0,0],[0,0,1,2,2,1,0,0],[0,0,5,1,1,3,0,0],[0,0,5,1,1,3,0,0],[0,0,1,4,4,1,0,0],[0,0,0,0,0,0,0,0],[2,0,0,0,0,0,0,5]],hint:[[2,2,2,0,0,0,0,3],[0,0,0,0,0,0,0,3],[0,0,0,0,0,0,0,3],[0,0,0,0,0,0,0,0],[0,0,0,
0,0,0,0,0],[5,0,0,0,0,0,0,0],[5,0,0,0,0,0,0,0],[5,0,0,0,0,4,4,4]]},{moves:[15,15],stars:[50,75,95],objects:[[0,0,2,1,1,1,4,1],[0,3,0,0,0,4,0,2],[0,1,3,4,4,1,1,2],[0,1,3,3,4,1,0,0],[0,0,1,0,1,1,1,0],[0,0,1,0,3,2,0,0],[0,0,1,2,0,2,0,0],[3,0,0,0,1,1,0,0]],hint:[[0,0,0,1,1,1,0,1],[0,3,3,0,4,4,2,2],[0,1,3,4,4,1,1,2],[0,1,3,3,4,1,0,2],[0,0,1,3,1,1,1,2],[0,0,1,0,0,0,0,2],[0,0,1,0,0,0,0,0],[0,0,0,0,1,1,0,0]]},{moves:[16,20],stars:[50,75,95],objects:[[4,4,1,0,3,1,2,2],[1,0,1,0,1,1,0,1],[5,0,4,0,0,0,0,0],[5,
0,0,0,0,0,0,0],[0,0,0,0,0,0,0,4],[0,0,0,0,0,5,0,4],[1,0,1,1,0,1,0,1],[3,3,1,2,0,1,5,5]],hint:[[4,4,1,0,0,1,2,2],[1,4,1,0,1,1,2,1],[0,4,4,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,5,5,0],[1,3,1,1,0,1,5,1],[3,3,1,0,0,1,5,5]]},{moves:[16,20],stars:[50,75,95],objects:[[0,5,0,0,2,0,0,3],[0,0,5,0,0,1,3,0],[0,1,1,1,0,1,0,0],[4,0,0,4,2,1,0,0],[0,0,1,3,5,0,0,5],[0,2,1,0,1,1,1,0],[2,0,1,0,0,4,0,0],[0,0,0,3,0,0,4,0]],hint:[[0,0,0,0,2,0,0,0],[0,0,0,0,2,0,0,0],[0,0,0,0,2,0,0,0],[4,4,4,4,2,0,0,
0],[0,0,0,3,5,5,5,5],[0,0,0,3,0,0,0,0],[0,0,0,3,0,0,0,0],[0,0,0,3,0,0,0,0]]},{moves:[20,20],stars:[50,75,95],objects:[[2,1,3,1,4,1,5,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,3,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[5,1,4,1,3,1,2,1]],hint:[[0,0,0,0,0,0,0,0],[3,3,3,0,0,0,5,2],[0,0,0,0,4,4,5,2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[15,20],stars:[50,75,95],objects:[[0,0,0,0,0,0,2,3],[0,0,0,0,0,0,0,0],[5,4,0,0,
0,0,0,0],[1,1,1,1,0,0,1,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[2,3,0,0,0,0,4,5]],hint:[[0,0,0,0,0,0,2,2],[0,0,0,0,0,0,0,3],[0,0,0,0,0,0,0,3],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,5],[0,0,0,0,0,4,4,5]]},{moves:[17,20],stars:[50,75,95],objects:[[0,0,0,5,3,0,0,5],[0,0,0,3,5,0,0,0],[0,0,0,1,1,0,0,0],[1,0,1,1,1,1,0,1],[0,0,0,1,1,0,0,0],[0,0,0,1,1,0,0,0],[0,0,0,5,3,0,0,0],[0,0,0,3,5,0,0,0]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,3,0,0,0,0,5,5],[0,
3,0,0,0,0,5,0],[3,3,0,0,0,0,5,5],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[18,20],stars:[50,75,95],objects:[[0,1,3,1,0,1,0,1],[3,1,0,1,0,1,0,1],[3,1,5,1,0,1,0,1],[0,1,0,0,0,1,0,1],[0,0,0,1,0,0,0,2],[0,1,0,1,0,1,0,1],[5,1,0,1,0,1,0,1],[2,1,0,1,5,1,0,1]],hint:[[0,0,5,0,0,0,0,0],[3,0,5,0,0,0,0,0],[3,0,5,0,0,0,0,0],[3,0,0,0,2,0,0,0],[0,0,0,0,2,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[16,20],stars:[50,75,95],objects:[[0,0,0,0,0,0,0,0],[2,1,0,0,0,0,1,
3],[3,1,0,0,0,0,1,2],[1,1,0,0,0,0,1,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],hint:[[2,2,0,0,0,0,3,3],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[16,20],stars:[50,75,95],objects:[[0,0,3,2,0,0,0,0],[0,1,0,0,0,0,1,2],[0,1,0,0,0,0,1,3],[0,1,0,0,0,0,1,4],[0,1,0,0,0,0,1,5],[0,0,0,0,0,0,0,0],[1,1,4,5,1,1,1,1],[1,4,4,5,5,1,1,1]],hint:[[0,0,0,0,3,2,0,0],[0,0,0,0,3,2,0,0],[0,0,0,0,
0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,4,5,0,0,0,0],[0,0,4,5,0,0,0,0],[0,4,4,5,5,0,0,0]]},{moves:[16,20],stars:[50,75,95],objects:[[0,0,0,1,1,0,0,0],[0,1,0,1,1,0,1,0],[0,1,0,1,1,0,1,0],[0,1,0,1,0,0,1,0],[0,1,0,4,4,0,5,0],[0,1,0,0,1,0,1,5],[0,1,0,4,4,0,1,4],[0,1,0,1,0,0,1,5]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,5,0,0],[0,0,0,0,0,5,0,0],[0,0,0,0,0,5,0,0],[0,0,4,4,0,0,0,0],[0,0,0,4,4,0,0,0],[0,0,0,0,4,0,0,0]]},{moves:[10,15],stars:[50,75,95],objects:[[3,0,0,0,0,0,0,0],[0,
0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[1,1,1,2,3,1,1,1],[0,0,2,3,2,3,3,0],[5,5,0,0,0,5,0,0],[5,0,0,0,0,5,0,0],[2,0,0,0,0,0,0,2]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,3,3,0,0,0],[0,0,0,3,3,3,0,0],[0,0,0,5,5,5,0,0],[0,0,0,5,2,5,0,0],[0,0,2,2,2,2,0,0]]},{moves:[26,31],stars:[50,75,95],objects:[[4,0,4,3,5,1,0,5],[0,0,0,3,5,2,0,2],[0,0,0,1,1,1,1,0],[0,1,0,2,0,0,1,0],[0,1,0,0,4,0,1,0],[0,1,1,1,1,0,0,0],[4,0,4,3,5,0,0,0],[3,0,1,3,5,2,0,2]],hint:[[0,0,0,0,5,0,5,0],[0,0,0,0,5,5,5,
0],[0,0,4,0,0,0,0,0],[0,0,4,2,2,2,0,0],[0,0,4,4,4,2,0,0],[0,0,0,0,0,2,0,0],[0,3,3,3,0,0,0,0],[0,3,0,3,0,0,0,0]]},{moves:[10,15],stars:[50,75,95],objects:[[2,1,0,2,0,0,2,0],[0,2,0,2,1,1,2,1],[0,0,1,1,0,3,0,4],[0,0,1,4,4,0,0,0],[1,0,1,0,0,0,0,0],[0,0,0,1,0,3,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,3]],hint:[[0,0,2,0,0,0,0,0],[0,2,2,0,0,0,0,0],[0,2,0,0,4,0,0,0],[2,2,0,4,4,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,3,0,0,0,0,0,0],[3,3,0,0,0,0,0,0]]},{moves:[16,20],stars:[50,75,95],objects:[[4,1,0,1,
0,0,0,4],[0,0,0,4,0,1,0,0],[0,4,1,4,2,1,2,0],[1,0,1,1,1,1,2,1],[0,0,0,0,0,0,0,0],[1,3,1,1,0,1,1,0],[0,3,0,0,0,0,0,0],[3,0,0,0,0,4,0,0]],hint:[[0,0,0,0,0,0,0,0],[0,4,4,4,0,0,2,0],[0,4,0,4,4,0,2,0],[0,3,0,0,0,0,2,0],[3,3,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]},{moves:[11,15],stars:[50,75,95],objects:[[3,3,0,0,3,1,0,0],[1,0,1,0,1,0,0,0],[1,3,3,0,1,0,0,0],[0,1,1,0,0,0,1,0],[2,0,0,0,4,1,4,0],[0,0,0,0,0,3,4,1],[1,1,0,0,0,3,4,0],[2,2,4,1,4,1,0,0]],hint:[[0,0,3,3,3,0,0,0],[0,
0,0,3,0,0,0,0],[0,3,3,3,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,4,0],[0,0,0,0,0,0,4,0],[0,0,0,0,4,4,4,0],[2,2,2,0,4,0,0,0]]},{moves:[18,20],stars:[50,75,95],objects:[[3,1,2,1,0,0,0,0],[3,1,2,1,0,0,0,0],[3,1,2,1,0,0,0,0],[0,0,0,0,0,0,5,4],[0,0,0,0,0,0,2,3],[4,1,5,1,0,0,0,0],[4,1,5,1,0,0,0,0],[4,1,5,1,0,0,0,0]],hint:[[3,1,0,1,0,0,0,0],[3,1,2,1,0,0,0,0],[3,1,2,1,0,0,0,0],[3,2,2,0,0,0,0,0],[4,0,5,5,0,0,0,0],[4,1,5,1,0,0,0,0],[4,1,5,1,0,0,0,0],[4,1,0,1,0,0,0,0]]}],e=0;e<d.length;e+=1)a.levels.push(d[e])};
a.testLevel={moves:[30,60],stars:[50,75,100],objects:[[4,1,0,1,0,0,0,4],[0,0,0,4,0,1,0,0],[0,4,1,4,2,1,2,0],[1,0,1,1,1,1,2,1],[0,0,0,0,0,0,0,0],[1,3,1,1,0,1,1,0],[0,3,0,0,0,0,0,0],[3,0,0,0,0,4,0,0]],hint:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]}})(window.OkijinGame=window.OkijinGame||{});(function(a,D){a.Camera=function(){if(!(this instanceof a.Camera))throw Error("Constructor called as a function.");this.reset()};a.Camera.prototype.reset=function(){this.y=this.x=0;this.sy=this.sx=1;this.angle=this.ty=this.tx=0;this.matrix=[1,0,0,1,0,0]};a.Camera.prototype.update=function(){this.matrix=[1,0,0,1,0,0];this.translate(this.x,this.y);this.scale(this.sx,this.sy);this.rotate(this.angle)};a.Camera.prototype.translate=function(a,e){this.matrix[4]+=this.matrix[0]*a+this.matrix[2]*e;this.matrix[5]+=
this.matrix[1]*a+this.matrix[3]*e};a.Camera.prototype.scale=function(a,e){this.matrix[0]*=a;this.matrix[1]*=a;this.matrix[2]*=e;this.matrix[3]*=e};a.Camera.prototype.rotate=function(a){var e=Math.cos(a);a=Math.sin(a);var c=this.matrix[1]*e+this.matrix[3]*a,k=this.matrix[0]*-a+this.matrix[2]*e,p=this.matrix[1]*-a+this.matrix[3]*e;this.matrix[0]=this.matrix[0]*e+this.matrix[2]*a;this.matrix[1]=c;this.matrix[2]=k;this.matrix[3]=p};a.Camera.prototype.screenToCamera=function(a,e){var c=a,k=e,p=1/(this.matrix[0]*
this.matrix[3]-this.matrix[1]*this.matrix[2]);a=c*this.matrix[3]*p+k*-this.matrix[2]*p+p*(this.matrix[2]*this.matrix[5]-this.matrix[3]*this.matrix[4]);e=c*-this.matrix[1]*p+k*this.matrix[0]*p+p*(this.matrix[1]*this.matrix[4]-this.matrix[0]*this.matrix[5]);return{x:a,y:e}};a.Camera.prototype.cameraToScreen=function(a,e){var c=a,k=e;a=c*this.matrix[0]+k*this.matrix[2]+this.matrix[4];e=c*this.matrix[1]+k*this.matrix[3]+this.matrix[5];return{x:a,y:e}};a.Camera.prototype.multiply=function(a){var e=this.matrix[1]*
a.matrix[0]+this.matrix[3]*a.matrix[1],c=this.matrix[0]*a.matrix[2]+this.matrix[2]*a.matrix[3],k=this.matrix[1]*a.matrix[2]+this.matrix[3]*a.matrix[3],p=this.matrix[0]*a.matrix[4]+this.matrix[2]*a.matrix[5]+this.matrix[4],n=this.matrix[1]*a.matrix[4]+this.matrix[3]*a.matrix[5]+this.matrix[5];this.matrix[0]=this.matrix[0]*a.matrix[0]+this.matrix[2]*a.matrix[1];this.matrix[1]=e;this.matrix[2]=c;this.matrix[3]=k;this.matrix[4]=p;this.matrix[5]=n}})(window.OkijinGame=window.OkijinGame||{});(function(a,D){a.Entity=function(){if(!(this instanceof a.Entity))throw Error("Constructor called as a function.");this.vy=this.vx=this.y=this.x=0;this.scaleFactor=1;this.angle=0;this.gravity=9.78;this.rotationFactor=0;this.mass=1;this.heartBeats=[]};a.Entity.prototype.update=function(a){var e,c,k;if(!this.paused)for(e=0,c=this.heartBeats.length;e<c;e+=1)k=this.heartBeats[e],0===k.direction&&k.time<=k.maxTime?(k.time=Math.min(k.time+a*k.speed1,k.maxTime),k.time===k.maxTime&&(k.direction=1)):1===k.direction&&
0<=k.time&&(k.time=Math.max(k.time-a*k.speed2,0),0===k.time&&(k.direction=0))};a.ButtonEntity=function(d,e,c,k){if(!(this instanceof a.ButtonEntity))throw Error("Constructor called as a function.");a.Entity.call(this);this.type=d;this.x=e;this.y=c;this.vy=this.vx=0;this.scaleFactor=1;this.angle=0;this.gravity=9.78;this.mass=8;this.friction=1;this.radius=k;this.enabled=!0;this.heartBeats=[{time:.9*Math.random(),direction:0,maxTime:1,speed1:1.5,speed2:1.5}]};a.ButtonEntity.prototype=Object.create(a.Entity.prototype);
a.ButtonEntity.prototype.update=function(d){a.Entity.prototype.update.call(this,d)};a.PolygonEntity=function(d){if(!(this instanceof a.PolygonEntity))throw Error("Constructor called as a function.");a.Entity.call(this);this.offset={x:0,y:0};this.center={x:0,y:0};this.vertices=[];this.outlineVertices=[];this.formTime=0;this.valid=this.isCut=!1;this.lifeTime=1.3;this.lastBreathTime=.3;this.rotationSpeed=.5<Math.random()?-3:3;this.locked=!1;this.object=d;this.oldY=this.oldX=this.movingOffsetY=this.movingOffsetX=
0;this.heartBeats=[{time:1.5*Math.random(),direction:0,maxTime:1.5,speed1:1,speed2:1.5},{time:Math.random(),direction:0,maxTime:1,speed1:1,speed2:1.5},{time:.5*Math.random(),direction:0,maxTime:.5,speed1:1,speed2:1.5}]};a.PolygonEntity.prototype=Object.create(a.Entity.prototype);a.PolygonEntity.prototype.initialize=function(){var d,e,c,k,p;if(2<this.vertices.length)for(d=this.vertices[this.vertices.length-1].x,e=this.vertices[this.vertices.length-1].y,c=0;c<this.vertices.length;)k=a.distance(d,e,
this.vertices[c].x,this.vertices[c].y),3<this.vertices.length&&.1>k?this.vertices.splice(c,1):(d=this.vertices[c].x,e=this.vertices[c].y,c++);this.isCut=!1;if(2<this.vertices.length)for(this.outlineVertices=[],d=this.vertices[this.vertices.length-1].x,e=this.vertices[this.vertices.length-1].y,c=0;c<this.vertices.length;c+=1){p=a.vectorAngle(d,e,this.vertices[c].x,this.vertices[c].y);k=a.distance(d,e,this.vertices[c].x,this.vertices[c].y);var n=.15;this.vertices[c].cut&&(.3>this.formTime?n=.15+(this.vertices[c].cut?
this.formTime:0):.6>this.formTime?n=.15+(this.vertices[c].cut?.6-this.formTime:0):.9>this.formTime&&(n=.15+(this.vertices[c].cut?this.formTime-.6:0)));var u=a.vectorRotate(k*n,0,p),n=a.vectorRotate(-k*n,0,p),t=a.vectorRotate(.35*k,0,p);k=a.vectorRotate(.35*-k,0,p);this.outlineVertices.push({x:d+u.x,y:e+u.y,bx:d+t.x,by:e+t.y,cx:d+u.x,cy:e+u.y,quad:3});this.outlineVertices.push({x:this.vertices[c].x+n.x,y:this.vertices[c].y+n.y,bx:this.vertices[c].x+k.x,by:this.vertices[c].y+k.y,cx:this.vertices[c].x+
n.x,cy:this.vertices[c].y+n.y,quad:1});this.outlineVertices.push({x:this.vertices[c].x,y:this.vertices[c].y,bx:this.vertices[c].x,by:this.vertices[c].y,cx:this.vertices[c].x,cy:this.vertices[c].y,quad:2});d=this.vertices[c].x;e=this.vertices[c].y;this.vertices[c].cut&&(this.isCut=!0)}else this.vertices=[];if(2<this.vertices.length){for(c=e=d=0;c<this.vertices.length;c+=1)d+=this.vertices[c].x,e+=this.vertices[c].y;this.center={x:d/this.vertices.length,y:e/this.vertices.length};for(c=0;c<this.outlineVertices.length;c+=
1)this.outlineVertices[c].bx*=.75,this.outlineVertices[c].by*=.75,this.outlineVertices[c].cx*=.975,this.outlineVertices[c].cy*=.975;d=this.center.x;e=this.center.y;u=this.center.x;c=this.center.y;d=.75*d-this.center.x;e=.75*e-this.center.y;u=.975*u-this.center.x;k=.975*c-this.center.y;for(c=0;c<this.outlineVertices.length;c+=1)this.outlineVertices[c].bx-=.85*d,this.outlineVertices[c].by-=.85*e,this.outlineVertices[c].cx-=1.7*u,this.outlineVertices[c].cy-=1.7*k}};a.PolygonEntity.prototype.update=function(d){0<
this.formTime&&(this.formTime-=d*Math.max(2*this.formTime,.5),0>this.formTime&&(this.formTime=0));this.valid&&0===this.formTime&&0<this.lastBreathTime&&(this.lastBreathTime-=2*d,0>this.lastBreathTime&&(this.lastBreathTime=0));this.isCut&&(this.scaleFactor=1+.15*this.formTime);a.Entity.prototype.update.call(this,d)};a.CellEntity=function(d,e,c,k,p,n){if(!(this instanceof a.CellEntity))throw Error("Constructor called as a function.");a.Entity.call(this);this.type=d;this.x=e;this.y=c;this.row=k;this.column=
p;this.radius=n;this.heartBeats=[{time:1.5*Math.random(),direction:0,maxTime:1.5,speed1:1,speed2:2},{time:Math.random(),direction:0,maxTime:1,speed1:1,speed2:2}]};a.CellEntity.prototype=Object.create(a.Entity.prototype);a.CellEntity.prototype.update=function(d){a.Entity.prototype.update.call(this,d)};a.ObjectEntity=function(d,e,c,k,p,n){if(!(this instanceof a.ObjectEntity))throw Error("Constructor called as a function.");a.Entity.call(this);this.type=d;this.x=e;this.y=c;this.tx=e;this.ty=c;this.row=
k;this.column=p;this.radius=n;this.speed=60;this.group=0;this.moving=this.moved=this.processed=this.selected=!1;this.effectTime=.05;this.canShowEffect=!1;this.dragOffsetY=this.dragOffsetX=0;this.dragDirection=a.DirectionEnum.None;if(this.type===a.ObjectTypeEnum.Letter1||this.type===a.ObjectTypeEnum.Letter2||this.type===a.ObjectTypeEnum.Letter3||this.type===a.ObjectTypeEnum.Letter4||this.type===a.ObjectTypeEnum.Letter5)this.speed=10;this.heartBeats=[{time:1.5*Math.random(),direction:0,maxTime:1.5,
speed1:1,speed2:2},{time:Math.random(),direction:0,maxTime:1,speed1:.3,speed2:5},{time:Math.random(),direction:0,maxTime:1,speed1:.1,speed2:3},{time:Math.random(),direction:0,maxTime:1,speed1:3,speed2:3}]};a.ObjectEntity.prototype=Object.create(a.Entity.prototype);a.ObjectEntity.prototype.update=function(d){var e=!1,c=!1;switch(this.dragDirection){case a.DirectionEnum.None:c=e=!0;break;case a.DirectionEnum.Left:case a.DirectionEnum.Right:c=!0;break;case a.DirectionEnum.Top:case a.DirectionEnum.Bottom:e=
!0}e&&(0<this.dragOffsetX?(this.dragOffsetX-=5*d,0>this.dragOffsetX&&(this.dragOffsetX=0)):0>this.dragOffsetX&&(this.dragOffsetX+=5*d,0<this.dragOffsetX&&(this.dragOffsetX=0)));c&&(0<this.dragOffsetY?(this.dragOffsetY-=5*d,0>this.dragOffsetY&&(this.dragOffsetY=0)):0>this.dragOffsetY&&(this.dragOffsetY+=5*d,0<this.dragOffsetY&&(this.dragOffsetY=0)));e=!0;c=a.distance(this.x,this.y,this.tx,this.ty);c>.3*this.radius&&(this.moving||(this.moving=!0,this.vx+=(this.tx-this.x)/c*this.speed,this.vy+=(this.ty-
this.y)/c*this.speed,this.my=this.mx=0),this.vx+=(this.tx-this.x)/c*this.speed*d*5,this.vy+=(this.ty-this.y)/c*this.speed*d*5,this.x+=this.vx*d,this.y+=this.vy*d,this.mx+=this.vx*d,this.my+=this.vy*d,c>a.distance(this.x,this.y,this.tx,this.ty)&&(e=!1));e&&(this.vy=this.vx=0,this.x=this.tx,this.y=this.ty,this.moving&&(this.moving=!1,this.heartBeats[2].direction=1,this.heartBeats[2].time=this.heartBeats[2].maxTime));if(this.type===a.ObjectTypeEnum.Letter1||this.type===a.ObjectTypeEnum.Letter2||this.type===
a.ObjectTypeEnum.Letter3||this.type===a.ObjectTypeEnum.Letter4||this.type===a.ObjectTypeEnum.Letter5)if(0===this.heartBeats[0].direction||.1<this.heartBeats[3].time)this.angle=this.heartBeats[3].time-.1*Math.PI;0<this.effectTime&&(this.effectTime-=d,0>=this.effectTime&&(this.effectTime=.02,this.canShowEffect=!0));a.Entity.prototype.update.call(this,d)}})(window.OkijinGame=window.OkijinGame||{});(function(a,D){a.Effect=function(d,e,c){if(!(this instanceof a.Effect))throw Error("Constructor called as a function.");this.x=d;this.y=e;this.radius=c;this.vy=this.vx=0;this.mass=this.friction=1;this.direction=a.DirectionEnum.None;this.angle=this.rotationSpeed=0;this.gravity=9.78;this.value=0;this.type=a.EffectTypeEnum.None;this.activationCooldown=0;this.selfDestroyTime=-1;this.startFadeTime=1;this.restoreBaseAngle=!1;this.cooldown=0;this.scaleFactor=1;this.scaleTime=-1;this.scaleSpeed=2;this.target=
null};a.Effect.prototype.update=function(d){0<this.activationCooldown&&(this.activationCooldown-=d,0>this.activationCooldown&&(this.activationCooldown=0));0<this.scaleTime&&(this.scaleTime-=d*this.scaleSpeed,0>this.scaleTime&&(this.scaleTime=0));0<this.cooldown&&(this.cooldown-=d,0>this.cooldown&&(this.cooldown=0));0<this.selfDestroyTime&&(this.selfDestroyTime-=d,0>this.selfDestroyTime&&(this.selfDestroyTime=0));0<this.vx?(this.vx-=this.friction*d,0>this.vx&&(this.vx=0)):0>this.vx&&(this.vx+=this.friction*
d,0<this.vx&&(this.vx=0));!this.restoreBaseAngle||this.restoreBaseAngle&&1<Math.abs(this.rotationSpeed)?0<this.rotationSpeed?(this.rotationSpeed-=this.friction*d,0>this.rotationSpeed&&(this.rotationSpeed=0)):0>this.rotationSpeed&&(this.rotationSpeed+=this.friction*d,0<this.rotationSpeed&&(this.rotationSpeed=0)):this.restoreBaseAngle&&(this.rotationSpeed=0);this.restoreBaseAngle&&0===this.rotationSpeed&&0!==this.angle&&(.1<a.shortestArc(this.angle,0)?this.angle=0<this.angle?this.angle+2*Math.PI*d:
this.angle-2*Math.PI*d:this.angle=0);this.angle=this.rotationSpeed?(this.angle+2*this.rotationSpeed*Math.PI*d)%(2*Math.PI):this.angle;this.vy+=this.gravity*d*this.mass;this.y+=this.vy*d;this.x+=this.vx*d};a.NumberEffect=function(d,e,c,k,p){if(!(this instanceof a.NumberEffect))throw Error("Constructor called as a function.");a.Effect.call(this,d,e,.5);this.gravity=5;this.friction=2;this.mass=.5;this.selfDestroyTime=2;this.startFadeTime=1;this.type=a.EffectTypeEnum.NumberEffect;this.angle=this.value=
0;this.rotationSpeed=.5<Math.random()?-.1*Math.PI:.1*Math.PI;this.vx=0;this.vy=-2;this.number=c;this.color=k;this.hasX=p;this.scaleTime=1.2;this.scaleSpeed=1};a.NumberEffect.prototype=Object.create(a.Effect.prototype);a.SparkEffect=function(d,e,c,k){if(!(this instanceof a.SparkEffect))throw Error("Constructor called as a function.");a.Effect.call(this,d,e,k);this.gravity=0;this.friction=2;this.selfDestroyTime=this.mass=.5;this.startFadeTime=.1;this.type=a.EffectTypeEnum.SparkEffect;this.angle=c;this.rotationSpeed=
.2*Math.PI;this.vx=.5<Math.random()?.3:-.3;this.vy=2*-(.5+Math.random());this.scaleFactor=1.3;this.scaleTime=.3;this.displayOffset=Math.floor(1.99*Math.random())};a.SparkEffect.prototype=Object.create(a.Effect.prototype)})(window.OkijinGame=window.OkijinGame||{});(function(a,D){a.SceneManager=function(){if(!(this instanceof a.SceneManager))throw Error("Constructor called as a function.");this.minX=1;this.minY=-10;this.maxX=this.minX+20;this.maxY=this.minY+20;this.width=this.maxX-this.minX;this.height=this.maxY-this.minY;this.margin=.05*this.width;this.unit=.2*this.width;this.size={x:0,y:0};this.zoomCamera=this.slowCamera=this.shakeCamera=!1;this.currentLevel=0;this.hintCost=3;this.showHintTime=0;this.grid={size:7};this.previousGrids=[];this.effects=[];this.polygons=
[];this.cells=[];this.objects=[];this.groups=[];this.hints=[];this.letters=[new a.ObjectEntity(a.ObjectTypeEnum.Letter1,0,0,0,0,0),new a.ObjectEntity(a.ObjectTypeEnum.Letter2,0,0,0,0,0),new a.ObjectEntity(a.ObjectTypeEnum.Letter3,0,0,0,0,0),new a.ObjectEntity(a.ObjectTypeEnum.Letter4,0,0,0,0,0),new a.ObjectEntity(a.ObjectTypeEnum.Letter5,0,0,0,0,0)];this.homeButton=new a.ButtonEntity(a.ButtonTypeEnum.Home,0,0,0);this.levelsButton=new a.ButtonEntity(a.ButtonTypeEnum.Levels,0,0,0);this.resetButton=
new a.ButtonEntity(a.ButtonTypeEnum.Reset,0,0,0);this.hintButton=new a.ButtonEntity(a.ButtonTypeEnum.Hint,0,0,0);this.undoButton=new a.ButtonEntity(a.ButtonTypeEnum.Undo,0,0,0);this.menuButton=new a.ButtonEntity(a.ButtonTypeEnum.Menu,0,0,0);this.okButton=new a.ButtonEntity(a.ButtonTypeEnum.Ok,0,0,0);this.retryButton=new a.ButtonEntity(a.ButtonTypeEnum.Retry,0,0,0);this.maxLevels=50;this.pack1Button=new a.ButtonEntity(a.ButtonTypeEnum.Pack,0,0,0);this.pack2Button=new a.ButtonEntity(a.ButtonTypeEnum.Pack,
0,0,0);this.dragObject=this.pointerEndPos=this.pointerStartPos=null;this.resetGroups=!1;this.limit=this.moves=0;this.firstMove=!0;this.moveTime=this.percentDone=this.groupToCreate=this.curGroupCount=this.minGroupCount=0;this.moveBeat=.5;this.oldStars=this.stars=this.starTime=0;this.showHint=!1;this.modalTime=0;this.oldShowMenu=this.showMenu=this.levelLost=this.levelWon=this.showStartDialog=this.showBadHintDialog=this.showHintDialog=!1;this.showMenuTime=0;this.showOptions=!1;this.showOptionsTime=0;
this.showLevels=!1;this.levelObjects=[];this.tutorialStep=this.startIndex=0;this.canProcessLevelEnded=this.showMoveTip=!1};a.SceneManager.prototype.loadLevel=function(){var d,e;a.userData.levels[this.currentLevel]||(a.userData.levels[this.currentLevel]={unlocked:1,stars:0,hint:0,reward:0});this.grid={size:8};this.effects=[];this.polygons=[];this.cells=[];this.objects=[];this.groups=[];this.hints=[];this.showMoveTip=!1;this.previousGrids=[];this.tutorialStep=0;this.levelData=a.levels[this.currentLevel];
this.levelData||(this.levelData=a.testLevel);this.moves=this.levelData.moves[1];this.limit=this.levelData.moves[0];this.firstMove=!0;this.oldStars=this.stars=this.percentDone=this.groupToCreate=this.curGroupCount=this.minGroupCount=0;this.startIndex=a.userData.packIndex;this.showOptions=this.levelLost=this.levelWon=this.showStartDialog=this.showBadHintDialog=this.showHintDialog=!1;var c=this.width/this.grid.size;for(d=0;d<this.grid.size;++d)for(this.cells.push([]),e=0;e<this.grid.size;++e)this.cells[d][e]=
new a.CellEntity(a.CellTypeEnum.None,this.minX+e*c+.5*c,this.minY+d*c+.5*c,d,e,.5*c);for(d=0;d<this.grid.size;++d)for(this.hints.push([]),e=0;e<this.grid.size;++e)this.hints[d][e]=new a.ObjectEntity(this.levelData.hint[d][e],this.minX+e*c+.5*c,this.minY+d*c+.5*c,d,e,.5*c);var k=.2*this.width,p=this.minX+.5*k,n=this.minY+.5*k;this.levelObjects=[];for(d=0;5>d;d+=1){for(e=0;5>e;e+=1)this.levelObjects.push(new a.ObjectEntity(a.ObjectTypeEnum.Level,p,n,0,0,.5*k)),p+=k;p=this.minX+.5*k;n+=k}k=[0,0,0,0,
0,0,0,0,0,0,0];for(d=0;d<this.grid.size;++d)for(this.objects.push([]),e=0;e<this.grid.size;++e)this.objects[d][e]=new a.ObjectEntity(this.levelData.objects[d][e],this.minX+e*c+.5*c,this.minY+d*c+.5*c,d,e,.5*c),this.levelData.objects[d][e]!==a.ObjectTypeEnum.None&&this.levelData.objects[d][e]!==a.ObjectTypeEnum.Block&&(k[this.levelData.objects[d][e]]+=1);for(d=0;d<k.length;d++)0<k[d]&&this.minGroupCount++;this.resetGroups=!0;a.SceneManager.prototype.setObjectGroups.call(this);this.groupToCreate=this.curGroupCount-
this.minGroupCount};a.SceneManager.prototype.update=function(d){var e,c;this.oldShowMenu!==this.showMenu&&(this.oldShowMenu=this.showMenu,this.showMenuTime=.5);0<this.showOptionsTime&&(this.showOptionsTime-=5*d,0>this.showOptionsTime&&(this.showOptionsTime=0));0<this.showMenuTime&&(this.showMenuTime-=1.5*d,0>this.showMenuTime&&(this.showMenuTime=0));0<this.showHintTime&&(this.showHintTime-=1.5*d,0>this.showHintTime&&(this.showHintTime=0));0<this.modalTime&&(this.modalTime-=2*d,0>this.modalTime&&(this.modalTime=
0));0<this.moveTime&&(this.moveTime-=d,0>this.moveTime&&(this.moveTime=0));0<this.moveBeat&&(this.moveBeat-=d,0>this.moveBeat&&(this.moveBeat=.5));0<this.starTime&&(this.starTime-=d,0>this.starTime&&(this.starTime=0));for(e=0;e<this.grid.size;++e)for(c=0;c<this.grid.size;++c)this.cells[e][c].update(d);var k=!1;for(e=0;e<this.grid.size;++e)for(c=0;c<this.grid.size;++c)this.objects[e][c].update(d),this.objects[e][c].moving&&(k=!0,this.objects[e][c].canShowEffect&&(this.objects[e][c].canShowEffect=!1,
this.effects.push(new a.SparkEffect(this.objects[e][c].x-Math.random()*this.objects[e][c].radius,this.objects[e][c].y-Math.random()*this.objects[e][c].radius,.5))));if(this.showHint)for(e=0;e<this.grid.size;++e)for(c=0;c<this.grid.size;++c)this.hints[e][c].update(d);if(this.showMenu)for(e=0;e<this.letters.length;++e)this.letters[e].update(d);else if(this.showLevels)for(e=0;e<this.levelObjects.length;++e)this.levelObjects[e].update(d);for(c=0;c<this.polygons.length;++c)this.polygons[c].object.type!==
a.ObjectTypeEnum.Block&&this.polygons[c].update(d);if(this.resetGroups&&!k&&!this.levelWon&&!this.levelLost){this.resetGroups=!1;a.SceneManager.prototype.setObjectGroups.call(this);e=100*(this.groupToCreate-(this.curGroupCount-this.minGroupCount))/this.groupToCreate;this.moves>this.levelData.moves[1]-this.levelData.moves[0]&&(c=this.percentDone,this.percentDone=e,c!==this.percentDone&&(this.shakeCamera=!0,c=!1,this.oldStars=this.stars,this.stars=0,this.levelData.stars[2]<=this.percentDone&&(this.stars=
3,c=!0,this.oldStars!==this.stars&&(this.starTime=.5,this.oldStars=this.stars,a.playSound("score"))),!c&&this.levelData.stars[1]<=this.percentDone&&(this.stars=2,c=!0,this.oldStars!==this.stars&&(this.starTime=.5,this.oldStars=this.stars,a.playSound("score"))),!c&&this.levelData.stars[0]<=this.percentDone&&(this.stars=1,this.oldStars!==this.stars&&(this.starTime=.5,this.oldStars=this.stars,a.playSound("score")))));if(100===e){a.playSound("win");this.levelWon=!0;this.modalTime=1;a.userData.levels[this.currentLevel].stars=
Math.max(this.stars,a.userData.levels[this.currentLevel].stars);3===a.userData.levels[this.currentLevel].stars&&(a.userData.levels[this.currentLevel].reward+=1,1===a.userData.levels[this.currentLevel].reward&&(a.userData.gold+=1));if(!a.isDemo||a.isDemo&&11>this.currentLevel)a.userData.levels[this.currentLevel+1]?a.userData.levels[this.currentLevel+1].unlocked=1:a.userData.levels[this.currentLevel+1]={unlocked:1,stars:0,hint:0,reward:0};2>a.userData.moveTip&&3>this.stars&&(this.showMoveTip=!0,a.userData.moveTip+=
1);a.saveUserData()}this.firstMove||(this.moves--,this.moveTime=.3,0>=this.moves&&!this.levelWon&&(this.levelLost=!0,this.modalTime=1,a.playSound("fail")));this.firstMove=!1}this.homeButton.update(d);this.levelsButton.update(d);this.okButton.update(d);this.retryButton.update(d);this.resetButton.update(d);this.undoButton.update(d);this.hintButton.update(d);this.menuButton.update(d);this.showLevels&&(this.pack1Button.update(d),this.pack2Button.update(d),this.pack3Button&&this.pack3Button.update(d),
this.pack4Button&&this.pack4Button.update(d))};a.SceneManager.prototype.retrieveSameTypeNeighbours=function(d,e){var c=d.row,k=d.column;d.processed||(d.processed=!0,e.push(d),0<c&&this.objects[c-1][k].type===d.type&&a.SceneManager.prototype.retrieveSameTypeNeighbours.call(this,this.objects[c-1][k],e),0<k&&this.objects[c][k-1].type===d.type&&a.SceneManager.prototype.retrieveSameTypeNeighbours.call(this,this.objects[c][k-1],e),c<this.grid.size-1&&this.objects[c+1][k].type===d.type&&a.SceneManager.prototype.retrieveSameTypeNeighbours.call(this,
this.objects[c+1][k],e),k<this.grid.size-1&&this.objects[c][k+1].type===d.type&&a.SceneManager.prototype.retrieveSameTypeNeighbours.call(this,this.objects[c][k+1],e));return e};a.SceneManager.prototype.setObjectGroups=function(){var d,e,c;this.polygons=[];var k=[],p=1;for(d=0;d<this.grid.size;++d)for(e=0;e<this.grid.size;++e){var n=[],n=a.SceneManager.prototype.retrieveSameTypeNeighbours.call(this,this.objects[d][e],n);if(n.length){for(c=0;c<n.length;++c)n[c].group=p;this.groups[p]=n.slice();k.push(this.groups[p]);
p++}}for(d=0;d<this.grid.size;++d)for(e=0;e<this.grid.size;++e)this.objects[d][e].processed=!1,this.objects[d][e].moved=!1;for(d=0;d<k.length;d+=1){p=[];n=k[d];for(e=0;e<n.length;e+=1)c=n[e],c.type!==a.ObjectTypeEnum.None&&(0<c.row&&this.objects[c.row-1][c.column].group===c.group||p.push({processed:!1,x1:c.x-c.radius,y1:c.y-c.radius,x2:c.x+c.radius,y2:c.y-c.radius}),0<c.column&&this.objects[c.row][c.column-1].group===c.group||p.push({processed:!1,x1:c.x-c.radius,y1:c.y+c.radius,x2:c.x-c.radius,y2:c.y-
c.radius}),c.row<this.grid.size-1&&this.objects[c.row+1][c.column].group===c.group||p.push({processed:!1,x2:c.x-c.radius,y2:c.y+c.radius,x1:c.x+c.radius,y1:c.y+c.radius}),c.column<this.grid.size-1&&this.objects[c.row][c.column+1].group===c.group||p.push({processed:!1,x2:c.x+c.radius,y2:c.y+c.radius,x1:c.x+c.radius,y1:c.y-c.radius})),c.segments=[];c=[];if(p.length){for(var u=p[0];u;){u.processed=!0;c.push(u);var t=this.width,r=null;for(e=0;e<p.length;e+=1)if(!p[e].processed){var q=a.distance(u.x2,
u.y2,p[e].x1,p[e].y1);q<t&&(t=q,r=p[e])}u=r}n[0].segments=c.slice();p=new a.PolygonEntity(n[0]);for(e=0;e<c.length;++e)n=c[e],p.vertices.push({x:n.x2+.2*Math.random(),y:n.y2+.2*Math.random(),cut:!0});p.formTime=.6;p.valid=!0;p.initialize();this.polygons.push(p)}}var f=this;this.polygons.sort(function(b,c){var d=a.distance(f.minX,f.maxY,b.center.x,b.center.y);return a.distance(f.minX,f.maxY,c.center.x,c.center.y)-d});for(d=this.curGroupCount=0;d<this.polygons.length;d++)this.polygons[d].object.type!==
a.ObjectTypeEnum.None&&this.polygons[d].object.type!==a.ObjectTypeEnum.Block&&this.curGroupCount++};a.SceneManager.prototype.getGroupMovementMagnitude=function(d,e){var c,k=0,p=0;switch(e){case a.DirectionEnum.Left:p=-1;break;case a.DirectionEnum.Right:p=1;break;case a.DirectionEnum.Top:k=-1;break;case a.DirectionEnum.Bottom:k=1}var n=this.grid.size;for(c=0;c<d.length;c+=1){var u=d[c];if(u.type===a.ObjectTypeEnum.None){n=0;break}for(var t=0,r=u.row+k,q=u.column+p,f=r<this.grid.size&&q<this.grid.size&&
0<=r&&0<=q?this.objects[r][q]:null;f&&(f.type===a.ObjectTypeEnum.None||f.type===u.type&&f.group===u.group);)t+=1,r+=k,q+=p,f=r<this.grid.size&&q<this.grid.size&&0<=r&&0<=q?this.objects[r][q]:null;t<n&&(n=t)}return n};a.SceneManager.prototype.resize=function(d){var e=a.getLayoutOrientation()===a.LayoutOrientationEnum.Landscape;d&&(this.size=a.screenToHud({x:d.x,y:d.y}));this.hudUnit=.2*Math.min(this.size.y,this.size.x);var c=.5*this.size.x-2*this.hudUnit+.1*this.hudUnit,k=this.hudUnit;for(d=0;d<this.letters.length;d+=
1){var p=this.letters[d];p.x=c+this.hudUnit*d*(d===this.letters.length-1?.95:1);p.y=k;p.tx=p.x;p.ty=p.y;p.radius=.5*this.hudUnit}this.menuButton.radius=.55*this.hudUnit;this.menuButton.x=this.size.x-this.menuButton.radius;this.menuButton.y=this.menuButton.radius;this.undoButton.radius=.55*this.hudUnit;e?(this.undoButton.x=this.size.x-this.undoButton.radius,this.undoButton.y=3.5*this.undoButton.radius):(this.undoButton.x=this.undoButton.radius,this.undoButton.y=this.size.y-.9*this.undoButton.radius);
this.hintButton.radius=.55*this.hudUnit;e?(this.hintButton.x=this.size.x-this.hintButton.radius,this.hintButton.y=5.5*this.hintButton.radius):(this.hintButton.x=.5*this.size.x,this.hintButton.y=this.size.y-.9*this.hintButton.radius);this.resetButton.radius=.55*this.hudUnit;e?(this.resetButton.x=this.size.x-this.resetButton.radius,this.resetButton.y=7.5*this.resetButton.radius):(this.resetButton.x=this.size.x-this.resetButton.radius,this.resetButton.y=this.size.y-.9*this.resetButton.radius);this.okButton.radius=
.6*this.hudUnit;this.okButton.x=.5*this.size.x+2.2*this.okButton.radius;this.okButton.y=.5*this.size.y+1.4*this.okButton.radius;this.retryButton.radius=.6*this.hudUnit;this.retryButton.x=.5*this.size.x-2.2*this.retryButton.radius;this.retryButton.y=.5*this.size.y+1.4*this.retryButton.radius;this.homeButton.radius=.55*this.hudUnit;this.homeButton.x=this.size.x-5*this.homeButton.radius;this.homeButton.y=this.homeButton.radius;this.levelsButton.radius=.55*this.hudUnit;this.levelsButton.x=this.size.x-
3*this.levelsButton.radius;this.levelsButton.y=this.homeButton.radius;c=0;k=[this.pack1Button,this.pack2Button,this.pack3Button,this.pack4Button];for(d=0;d<k.length;d+=1)k[d]&&(k[d].radius=.4*this.hudUnit,e?(k[d].x=k[d].radius,k[d].y=1.5*this.hudUnit+c):(k[d].y=this.size.y-k[d].radius,k[d].x=3*k[d].radius+c),c+=2*k[d].radius)}})(window.OkijinGame=window.OkijinGame||{});(function(a,D){})(window.OkijinGame.Resources=window.OkijinGame.Resources||{});(function(a,D){var d={},e=!0,c=!1,k=navigator.userAgent.toLowerCase();if(-1<k.indexOf("firefox")||-1<k.indexOf("opera"))c=!0;k=!1;if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))k=!0;var p,n=window.AudioContext||window.webkitAudioContext;!c&&n?p=new n:"undefined"===typeof Audio?
e=!1:!c&&k&&(e=!1);a.canPlaySounds=function(){return e};a.registerSound=function(a,k,n){if(e)if(p){var q=new XMLHttpRequest;q.open("get",k,!0);q.responseType="arraybuffer";q.onload=function(){p.decodeAudioData(q.response,function(f){d[a]={buffer:f};n&&n()})};q.send()}else d[a]=new Audio,n&&(d[a].preload="auto",$(d[a]).on("loadeddata",n)),d[a].src=c?k.replace(".mp3",".ogg"):k;else n&&n()};a.playSound=function(c){try{var k;e&&(k=d[c])&&(p?(a.stopSound(c),k.sourceNode=p.createBufferSource(),k.sourceNode.buffer=
k.buffer,k.sourceNode.connect(p.destination),"undefined"!==typeof k.sourceNode.noteOn?k.sourceNode.noteOn(0):k.sourceNode.start(0)):(k.currentTime=0,k.play()))}catch(n){}};a.loopSound=function(c){var k;e&&(k=d[c])&&(p?(a.stopSound(c),k.sourceNode=p.createBufferSource(),k.sourceNode.loop=!0,k.sourceNode.buffer=k.buffer,k.sourceNode.connect(p.destination),"undefined"!==typeof k.sourceNode.noteOn?k.sourceNode.noteOn(0):k.sourceNode.start(0)):("boolean"===typeof k.loop?k.loop=!0:k.addEventListener("ended",
function(){this.currentTime=0;this.play()},!1),k.play()))};a.stopSound=function(a){e&&(a=d[a])&&(p?a.sourceNode&&("undefined"!==typeof a.sourceNode.noteOff?a.sourceNode.noteOff(0):a.sourceNode.stop(0),a.sourceNode=null):(a.pause(),a.currentTime=0))}})(window.AudioManager=window.AudioManager||{});
(function(a,D){var d=new Date,e=0,c=0;a.getFPS=function(){++e;var a=new Date;1E3<a.getTime()-d.getTime()&&(c=e,e=0,d=a);return c};a.clamp=function(a,c,d){return Math.max(c,Math.min(d,a))};a.circleRectIntersect=function(c,d,e,u,t,r,q){c-=a.clamp(c,u,r);d-=a.clamp(d,t,q);return c*c+d*d<e*e};a.distance=function(a,c,d,e){a=d-a;c=e-c;return Math.sqrt(a*a+c*c)};a.vectorAdd=function(a,c,d,e){return{x:a+d,y:c+e}};a.vectorSubstract=function(a,c,d,e){return{x:a-d,y:c-e}};a.vectorMultiply=function(a,c,d){return{x:a*
d,y:c*d}};a.vectorDivide=function(a,c,d){return 0===d?{x:a,y:c}:{x:a/d,y:c/d}};a.vectorDotProduct=function(a,c,d,e){return a*d+c*e};a.vectorLength=function(a,c){return Math.sqrt(a*a+c*c)};a.vectorNormalize=function(c,d){var e=a.vectorLength(c,d);return 0===e?{x:c,y:d}:{x:c/e,y:d/e}};a.vectorRotate=function(a,c,d){var e=Math.cos(d);d=Math.sin(d);return{x:e*a-d*c,y:d*a+e*c}};a.vectorAngle=function(a,c,d,e){return Math.atan2(e-c,d-a)};a.vectorFromAngle=function(a){return{x:Math.cos(a),y:Math.sin(a)}};
a.toDegrees=function(a){return 180/Math.PI*a};a.toRadians=function(a){return Math.PI/180*a};a.shortestArc=function(a,c){var d=Math.abs(a-c);d>Math.PI&&(d=2*Math.PI-d);return d};a.rectIntersect=function(a,c,d,e,t,r,q,f){return!(e<r||c>f||d<t||a>q)};a.pointInRect=function(a,c,d,e,t,r){return a>d&&a<t&&c>e&&c<r};a.circleLineIntersect=function(a,c,d,e,t,r,q){d-=a;e-=c;var f=2*(d*(a-t)+e*(c-r)),b;b=t*t+r*r+(a*a+c*c);b-=2*(t*a+r*c);b-=q*q;return 0>f*f-4*(d*d+e*e)*b?!1:!0};a.lineLineIntersect=function(a,
c,d,e,t,r,q,f){var b={intersect:!1,x:0,y:0},l=(f-r)*(d-a)-(q-t)*(e-c);0!==l?(q=((q-t)*(c-r)-(f-r)*(a-t))/l,t=((d-a)*(c-r)-(e-c)*(a-t))/l,0<=q&&1>=q&&0<=t&&1>=t?(b.intersect=!0,b.x=a+q*(d-a),b.y=c+q*(e-c)):b.intersect=!1):b.intersect=!1;return b};a.loadResources=function(a,c,d){var e,t,r={},q=0,f,b=function(){++q===t&&c&&c(r);d&&d(q,t)};e=0;for(t=a.length;e<t;e+=1)f=a[e],"img"===f.type?(r[f.id]=new Image,r[f.id].onload=b,r[f.id].src=f.src):"snd"===f.type&&AudioManager.registerSound(f.id,f.src,b)}})(window.OkijinGame=
window.OkijinGame||{});(function(a,D){var d,e,c,k,p,n,u,t,r,q;a.setupTileOffsets=function(){var f=1/a.getScaleUnit();d=0;e=1*f;c=2*f;k=3*f;p=4*f;n=5*f;u=6*f;t=7*f;r=8*f;q=9*f};a.draw=function(f,b){var l;l=a.getCurrentGameState();f.fillStyle="rgb(247, 240, 232)";f.fillRect(0,0,a.getCanvasWidth(),a.getCanvasHeight());if(l===a.GameStateEnum.GameLoading)a.drawLoader(f);else if(l===a.GameStateEnum.GameRun){f.save();a.applySceneCameras();a.applyHereParallaxCameras();f.save();a.applyVeryFarParallaxCameras();f.drawImage(a.Resources.background01Image,
d,d,n,n,b.minX-1,b.minY-5,30,30);f.restore();f.save();a.applyFarParallaxCameras();f.drawImage(a.Resources.background01Image,n,d,n,n,b.minX-14,b.minY-1,30,30);f.restore();f.save();a.applyNearParallaxCameras();f.drawImage(a.Resources.background01Image,d,d,n,n,b.minX-1,b.minY-25,30,30);f.restore();b.showHint&&(f.globalAlpha=1-2*b.showHintTime,f.fillStyle="rgba(0, 0, 0, 0.45)",f.fillRect(b.minX,b.minY,b.width,b.height));f.drawImage(a.Resources.hud01Image,d,c,r,r,b.minX,b.minY,b.width,b.height);if(!b.showMenu&&
!b.showLevels)a.drawLevelPlay(f,b);else if(b.showLevels){var g=b.startIndex;for(l=0;l<b.levelObjects.length;l+=1)g++,a.drawLevelObject(f,b.levelObjects[l],b,g)}for(l=0;l<b.effects.length;l+=1)a.drawEffect(f,b.effects[l],b);f.restore();f.save();a.applyHudCameras();if(b.showMenu){l=b.size;var g=.5*b.hudUnit,h=b.showMenuTime*g*10;f.drawImage(a.Resources.entities02Image,d,k,u,k,l.x/2-3*g-h,4*g-h,6*g+2*h,3*g+2*h);f.drawImage(a.Resources.entities02Image,d,u,u,c,0,l.y-1.6*g+2*h,6*g*.8,1.6*g);f.drawImage(a.Resources.entities02Image,
u,k,e,e,l.x/2+g-h,6*g-h,1.3*g+2*h,1.3*g+2*h);f.drawImage(a.Resources.entities02Image,t,k,k,e,l.x/2-1.8*g-3*h,7*g,3*g,g);for(l=0;l<b.letters.length;l+=1)a.drawLetter(f,b.letters[l],b);a.isSoundEnabled?f.drawImage(a.Resources.hud01Image,q,u,e,e,0,0,g,g):f.drawImage(a.Resources.hud01Image,r,t,e,e,0,0,g,g)}else if(b.showLevels)for(g=.5*b.hudUnit,a.drawButton(f,b.menuButton,b),f.drawImage(a.Resources.entities02Image,u,r,c,c,0,0,2*g,2*g),g=[b.pack1Button,b.pack2Button,b.pack3Button,b.pack4Button],l=0;l<
g.length;l+=1)g[l]&&a.drawButton(f,g[l],b,l);else a.drawHud(f,b);f.restore()}};a.drawLoader=function(f){a.getLayoutOrientation();var b=a.screenToHud({x:a.getCanvasWidth(),y:a.getCanvasHeight()}),e=a.getGameLoadingData();f.save();a.applyHudCameras();e=5*e.current/e.total;f.drawImage(a.Resources.loadingScreenImage,d,t,n,c,b.x/2-2.5,b.y/2,5,2);f.save();f.beginPath();f.rect(b.x/2-2.5,b.y/2,e,2);f.closePath();f.clip();f.drawImage(a.Resources.loadingScreenImage,d,n,n,c,b.x/2-2.5,b.y/2,5,2);f.restore();
f.drawImage(a.Resources.loadingScreenImage,d,k,n,c,b.x/2-2.5,b.y/2,5,2);f.restore()};a.drawLevelPlay=function(f,b){var e,g;g=[];for(e=0;e<b.polygons.length;e+=1){var h=b.polygons[e];if(2<h.vertices.length){var p=!0;b.showHint&&!h.object.moving&&h.object.type!==a.ObjectTypeEnum.Block&&(p=!1);g.push(h.object);p&&a.drawObject(f,h.object,b,!1);f.save();h.object.type===a.ObjectTypeEnum.Block||h.object.moving||(f.globalAlpha=1-2*b.showHintTime);h.object.moving?f.translate(h.object.mx,h.object.my):f.translate(h.object.dragOffsetX,
h.object.dragOffsetY);p&&(f.translate(h.center.x,h.center.y),f.scale(h.scaleFactor,h.scaleFactor),f.rotate(h.angle),f.translate(-h.center.x,-h.center.y),f.translate(-h.offset.x,-h.offset.y),a.drawPolygonOutline(f,h,b),a.drawPolygonBody(f,h,b),a.drawPolygonHighlight(f,h,b));f.restore()}}for(e=0;e<g.length;++e)p=!0,b.showHint&&!g[e].moving&&g[e].type!==a.ObjectTypeEnum.Block&&(p=!1),g[e].type===a.ObjectTypeEnum.Block||h.object.moving||(f.globalAlpha=1-2*b.showHintTime),p&&a.drawObject(f,g[e],b,!0),
f.globalAlpha=1;if(b.showHint)for(f.globalAlpha=1-2*b.showHintTime,e=0;e<b.grid.size;++e)for(g=0;g<b.grid.size;++g)b.hints[e][g].type!==a.ObjectTypeEnum.None&&b.hints[e][g].type!==a.ObjectTypeEnum.Block&&a.drawHint(f,b.hints[e][g],b);b.showHint||b.levelWon||b.levelLost||(0===b.currentLevel?(f.drawImage(a.Resources.background01Image,d,n,n,c,b.minX+.5*b.width-2.8*b.unit*.7,b.minY+2.8*b.unit,3.5*b.unit,1.4*b.unit),0===a.getTitleHeartbeat3().direction&&0===b.percentDone?(f.globalAlpha=.75<a.getTitleHeartbeat3().time?
1-4*(a.getTitleHeartbeat3().time-.75):1,f.drawImage(a.Resources.background01Image,n,n,c,k,b.minX+.5*b.width+.7*b.unit-a.getTitleHeartbeat3().time*b.unit*2.5,b.minY+.9*b.unit,1.4*b.unit,3*b.unit*.7)):0===a.getTitleHeartbeat3().direction&&100!==b.percentDone&&1===b.tutorialStep&&(f.globalAlpha=.75<a.getTitleHeartbeat3().time?1-4*(a.getTitleHeartbeat3().time-.75):1,f.drawImage(a.Resources.background01Image,t,n,k,c,b.minX+.5*b.width+.1*b.unit,b.minY+a.getTitleHeartbeat3().time*b.unit*1.5,3*b.unit*.6,
1.2*b.unit))):1===b.currentLevel&&f.drawImage(a.Resources.background01Image,d,t,n,c,b.minX+.5*b.width-2.8*b.unit-a.getTitleHeartbeat3().time*b.unit*.1,b.minY+1.3*b.unit,3.5*b.unit,1.4*b.unit))};a.drawHud=function(f,b){var l=b.size,g=.5*b.hudUnit,h=5*g,v=b.percentDone*h/100,C=5*b.percentDone/100;0===b.percentDone&&(C=1E-4*e,v=1E-4*g);f.save();if(!b.levelWon&&!b.levelLost){b.showHint||(a.drawButton(f,b.resetButton,b),a.drawButton(f,b.undoButton,b),a.drawButton(f,b.menuButton,b));a.drawButton(f,b.hintButton,
b);if(b.moves>b.levelData.moves[1]-b.levelData.moves[0])f.drawImage(a.Resources.loadingScreenImage,n,n,c,c,.1*g,.03*g,2*g,2*g);else{var z=.3*b.moveBeat;f.drawImage(a.Resources.loadingScreenImage,n,t,c,c,.1*g-z,.03*g-z,2*g+2*z,2*g+2*z)}a.drawNumber(f,Math.max(0,Math.floor(b.moves)).toString(),1.05*g,1.5*g,.8*g+b.moveTime,2,!1)}f.save();a.getLayoutOrientation()===a.LayoutOrientationEnum.Landscape&&(f.translate(.5*l.x,0),f.rotate(.5*-Math.PI),f.translate(.5*-l.x,0),f.translate(.46*-l.y,.5*-l.x));f.drawImage(a.Resources.loadingScreenImage,
d,t,n,c,l.x/2-.5*h,0,h,2*g);f.drawImage(a.Resources.loadingScreenImage,d,n,e*C,c,l.x/2-.5*h,0,v,2*g);f.drawImage(a.Resources.loadingScreenImage,d,k,n,c,l.x/2-.5*h,0,h,2*g);v=h*b.levelData.stars[2]/100;C=3<=b.stars?0:c;z=3===b.stars&&b.starTime?b.starTime:0;f.drawImage(a.Resources.loadingScreenImage,q,e,e,e,l.x/2-.5*h-.5*g+v,.56*g,g,g);f.drawImage(a.Resources.loadingScreenImage,q,d+C,e,e,l.x/2-.5*h-.5*g+v-z,0-z,g+2*z,g+2*z);v=h*b.levelData.stars[1]/100;C=2<=b.stars?0:c;z=2===b.stars&&b.starTime?b.starTime:
0;f.drawImage(a.Resources.loadingScreenImage,q,e,e,e,l.x/2-.5*h-.5*g+v,.56*g,g,g);f.drawImage(a.Resources.loadingScreenImage,q,d+C,e,e,l.x/2-.5*h-.5*g+v-z,0-z,g+2*z,g+2*z);v=h*b.levelData.stars[0]/100;C=1<=b.stars?0:c;z=1===b.stars&&b.starTime?b.starTime:0;f.drawImage(a.Resources.loadingScreenImage,q,e,e,e,l.x/2-.5*h-.5*g+v,.56*g,g,g);f.drawImage(a.Resources.loadingScreenImage,q,d+C,e,e,l.x/2-.5*h-.5*g+v-z,0-z,g+2*z,g+2*z);f.restore();b.showHintDialog&&(h=.4*(1-2*b.modalTime),f.fillStyle="rgba(255, 255, 255,"+
h+")",f.fillRect(0,0,l.x,l.y),f.drawImage(a.Resources.entities01Image,p,c,u,p,l.x/2-3*g*1.3-b.modalTime*g*30,l.y/2-2.6*g,6*g*1.3,5.2*g));b.showBadHintDialog&&f.drawImage(a.Resources.entities03Image,d,d,u,p,l.x/2-3*g*1.3-b.modalTime*g*30,l.y/2-2.6*g,6*g*1.3,5.2*g);b.showStartDialog&&(h=.4*(1-2*b.modalTime),f.fillStyle="rgba(255, 255, 255,"+h+")",f.fillRect(0,0,l.x,l.y),f.drawImage(a.Resources.entities03Image,d,p,u,p,l.x/2-3*g*1.3-b.modalTime*g*30,l.y/2-2.6*g,6*g*1.3,5.2*g),a.drawNumber(f,b.limit.toString(),
l.x/2+1.3*g-b.modalTime*g*30,l.y/2-.25*g,g,2,!1));if(b.levelWon||b.levelLost)h=.6*(1-2*Math.max(0,b.modalTime-.5)),f.fillStyle="rgba(255, 255, 255,"+h+")",f.fillRect(0,0,l.x,l.y),f.drawImage(a.Resources.entities01Image,p,u,u,p,l.x/2-3*g*1.3-b.modalTime*g*30,l.y/2-2.6*g,6*g*1.3,5.2*g),b.levelWon?(f.drawImage(a.Resources.entities01Image,d,u,c,c,l.x/2-4.55*g-b.modalTime*g*30,l.y/2-2.6*g-.7*a.getTitleHeartbeat1().time,2.6*g,2.6*g),f.drawImage(a.Resources.entities01Image,p,d,k,e,l.x/2-1.5*g*1.3-b.modalTime*
g*30,l.y/2-2.6*g,3*g*1.3,1.3*g)):(f.drawImage(a.Resources.entities01Image,d,r,c,c,l.x/2-4.55*g-b.modalTime*g*30,l.y/2-2.6*g-.7*a.getTitleHeartbeat1().time,2.6*g,2.6*g),f.drawImage(a.Resources.entities01Image,p,e,k,e,l.x/2-1.5*g*1.3-b.modalTime*g*30,l.y/2-1.5*g*1.3,3*g*1.3,1.3*g),f.drawImage(a.Resources.hud01Image,d,d,k,c,l.x/2-1.5*g-b.modalTime*g*30+a.getTitleHeartbeat1().time*g*.3,l.y/2-.5*g,3*g,2*g)),a.drawNumber(f,(b.currentLevel+1).toString(),l.x/2+2.3*g*1.3-b.modalTime*g*30,l.y/2-.68*g*1.3,.8*
g,2,!1),b.levelWon&&.5>b.modalTime&&(f.save(),1<=b.stars&&(f.translate(l.x/2-1.5*g,l.y/2),f.rotate(-.25*Math.PI+a.getTitleHeartbeat2().time*Math.PI),f.translate(-(l.x/2-1.5*g),-(l.y/2))),f.drawImage(a.Resources.entities01Image,c,u+(1<=b.stars?d:c),c,c,l.x/2-2.5*g-b.modalTime*g*30,l.y/2-1*g,2*g,2*g),f.restore(),f.save(),2<=b.stars&&(f.translate(l.x/2,l.y/2-.5*g),f.rotate(-.15*Math.PI+a.getTitleHeartbeat2().time*Math.PI),f.translate(-(l.x/2),-(l.y/2-.5*g))),f.drawImage(a.Resources.entities01Image,c,
u+(2<=b.stars?d:c),c,c,l.x/2-g-b.modalTime*g*30,l.y/2-1.5*g,2*g,2*g),f.restore(),f.save(),3<=b.stars&&(f.translate(l.x/2+1.5*g,l.y/2),f.rotate(-.1*Math.PI+a.getTitleHeartbeat2().time*Math.PI),f.translate(-(l.x/2+1.5*g),-(l.y/2))),f.drawImage(a.Resources.entities01Image,c,u+(3<=b.stars?d:c),c,c,l.x/2+.5*g-b.modalTime*g*30,l.y/2-1*g,2*g,2*g),f.restore(),3===b.stars&&1===a.userData.levels[b.currentLevel].reward&&f.drawImage(a.Resources.hud01Image,r,p,c,c,l.x/2-g-b.modalTime*g*30,l.y/2+.2*g,2*g,2*g),
3!==b.stars||1!==a.userData.levels[b.currentLevel].reward||1!==b.currentLevel&&0!==b.currentLevel||f.drawImage(a.Resources.hud01Image,k,d,n,c,l.x/2-.3*g+b.modalTime*g*30,l.y/2+2.5*g,5*g,2*g),b.showMoveTip&&f.drawImage(a.Resources.background01Image,n,r,n,c,l.x/2.3-2*g+b.modalTime*g*30,l.y/2+2.5*g,5*g,2*g));b.levelWon||b.levelLost||!b.showOptions&&!b.showOptionsTime||(a.drawButton(f,b.homeButton,b),a.drawButton(f,b.levelsButton,b));f.restore()};a.drawNumber=function(c,b,l,g,h,k,p){var n,q=l-.35*b.length-
(p?-.4:0);n=l+(p?.4:0);k*=e;l=a.Resources.loadingScreenImage;c.save();c.translate(n,g);c.scale(h,h);c.translate(-n,-g);p&&(q+=.5,c.drawImage(l,r,k,e,e,q-1,g-1,1,1));h=0;for(p=b.length;h<p;h+=1)n=b.charAt(h),n=parseInt(n,10)*e*.8,c.drawImage(l,d+n,k,.77*e,e,q,g-1,.8,1),q+=.7;c.restore()};a.drawButton=function(f,b,l,g){var h=b.x-b.radius,v=b.y-b.radius;f.save();b.clicked&&f.translate(.05*b.radius,.05*b.radius);b.direction===a.DirectionEnum.Right&&(f.translate(2*b.x,0),f.scale(-1,1));f.translate(b.x,
b.y);f.scale(b.scaleFactor,b.scaleFactor);f.translate(-b.x,-b.y);f.translate(b.x,b.y);f.rotate(b.angle);f.translate(-b.x,-b.y);b.type!==a.ButtonTypeEnum.Menu&&b.type!==a.ButtonTypeEnum.Home&&b.type!==a.ButtonTypeEnum.Levels&&b.type!==a.ButtonTypeEnum.Pack&&(l.showHint?b.type!==a.ButtonTypeEnum.Hint?f.drawImage(a.Resources.loadingScreenImage,t,t,c,c,h,v,2*b.radius,2*b.radius):f.drawImage(a.Resources.loadingScreenImage,t,n,c,c,h,v,2*b.radius,2*b.radius):b.type===a.ButtonTypeEnum.Undo&&0===l.previousGrids.length||
b.type===a.ButtonTypeEnum.Hint&&a.userData.gold<l.hintCost?f.drawImage(a.Resources.loadingScreenImage,t,t,c,c,h,v,2*b.radius,2*b.radius):b.clicked?f.drawImage(a.Resources.loadingScreenImage,t,n,c,c,h,v,2*b.radius,2*b.radius):f.drawImage(a.Resources.loadingScreenImage,t,k,c,c,h,v,2*b.radius,2*b.radius));switch(b.type){case a.ButtonTypeEnum.Reset:f.save();f.translate(h+.5*b.radius,v+.5*b.radius);.5<b.heartBeats[0].time&&!l.showHint&&f.rotate(-.3*Math.PI+.6*b.heartBeats[0].time*Math.PI);f.translate(-(h+
.5*b.radius),-(v+.5*b.radius));f.drawImage(a.Resources.loadingScreenImage,q,n,e,e,h,v,b.radius,b.radius);f.restore();f.drawImage(a.Resources.loadingScreenImage,p,q,c,e,h,v+.6*b.radius,2*b.radius,b.radius);break;case a.ButtonTypeEnum.Undo:f.save();.5<b.heartBeats[0].time&&0<l.previousGrids.length&&!l.showHint&&f.translate(.25*b.radius-.5*b.heartBeats[0].time*b.radius,0);0===l.previousGrids.length?f.drawImage(a.Resources.loadingScreenImage,q,r,e,e,h+.2*b.radius,v,b.radius,b.radius):f.drawImage(a.Resources.loadingScreenImage,
q,p,e,e,h+.2*b.radius,v,b.radius,b.radius);f.restore();f.drawImage(a.Resources.loadingScreenImage,c,q,c,e,h,v+.6*b.radius,2*b.radius,b.radius);break;case a.ButtonTypeEnum.Hint:f.save();f.translate(h+.5*b.radius,v+.5*b.radius);(.5<b.heartBeats[0].time&&a.userData.gold>=l.hintCost||l.showHint||a.userData.levels[l.currentLevel].hint)&&f.scale(1+.2*(b.heartBeats[0].time-.5)*b.radius*2+(l.showHint?1:0)*b.radius,1+.2*(b.heartBeats[0].time-.5)*b.radius*2+(l.showHint?1:0)*b.radius);f.translate(-(h+.5*b.radius),
-(v+.5*b.radius));a.userData.gold>=l.hintCost||a.userData.levels[l.currentLevel].hint?f.drawImage(a.Resources.loadingScreenImage,q,k,e,e,h,v,b.radius,b.radius):f.drawImage(a.Resources.loadingScreenImage,q,t,e,e,h,v,b.radius,b.radius);f.restore();f.drawImage(a.Resources.loadingScreenImage,d,q,c,e,h+.1*b.radius,v+.27*b.radius,2*b.radius,b.radius);a.userData.levels[l.currentLevel].hint||(f.drawImage(a.Resources.loadingScreenImage,q,u,e,e,h+.9*b.radius,v+.9*b.radius,b.radius,b.radius),a.drawNumber(f,
Math.min(99,Math.floor(a.userData.gold)).toString(),h+1.36*b.radius,v+1.65*b.radius,.5*b.radius,2,!1));break;case a.ButtonTypeEnum.Menu:l.showLevels?f.drawImage(a.Resources.entities02Image,r,p,c,c,h,v,2*b.radius,2*b.radius):l.showOptions?f.drawImage(a.Resources.entities02Image,u,p,c,c,h,v,2*b.radius,2*b.radius):f.drawImage(a.Resources.loadingScreenImage,n,k,c,c,h,v,2*b.radius,2*b.radius);break;case a.ButtonTypeEnum.Home:f.drawImage(a.Resources.entities02Image,u,u,p,c,h,v-(l.showOptions?l.showOptionsTime:
.5-l.showOptionsTime)*b.radius*3-.3*b.radius,4*b.radius,2*b.radius);break;case a.ButtonTypeEnum.Retry:case a.ButtonTypeEnum.Ok:f.drawImage(a.Resources.loadingScreenImage,n,k,c,c,h,v,2*b.radius,2*b.radius);break;case a.ButtonTypeEnum.Pack:f.drawImage(a.Resources.entities02Image,d,r,c,c,h,v,2*b.radius,2*b.radius),f.drawImage(a.Resources.hud01Image,r,d+g*e,c,e,h,v+b.radius,2*b.radius,b.radius)}f.restore()};a.drawLetter=function(f,b,e){e=b.x-b.radius;var g=b.y-1.5*b.radius;f.save();f.translate(0,b.heartBeats[1].time*
b.radius);b.direction===a.DirectionEnum.Right&&(f.translate(2*b.x,0),f.scale(-1,1));f.translate(b.x,b.y);f.scale(b.scaleFactor,b.scaleFactor);f.translate(-b.x,-b.y);f.translate(b.x,b.y);f.rotate(b.angle);f.translate(-b.x,-b.y);switch(b.type){case a.ObjectTypeEnum.Letter1:f.drawImage(a.Resources.entities02Image,d,d,c,k,e,g,2*b.radius,3*b.radius);break;case a.ObjectTypeEnum.Letter2:f.drawImage(a.Resources.entities02Image,c,d,c,k,e,g,2*b.radius,3*b.radius);break;case a.ObjectTypeEnum.Letter3:f.drawImage(a.Resources.entities02Image,
p,d,c,k,e,g,2*b.radius,3*b.radius);break;case a.ObjectTypeEnum.Letter4:f.drawImage(a.Resources.entities02Image,u,d,c,k,e,g,2*b.radius,3*b.radius);break;case a.ObjectTypeEnum.Letter5:f.drawImage(a.Resources.entities02Image,r,d,c,k,e,g,2*b.radius,3*b.radius)}f.restore()};a.drawLevelObject=function(f,b,d,g){d=b.x-b.radius;var k=b.y-b.radius;f.save();b.direction===a.DirectionEnum.Right&&(f.translate(2*b.x,0),f.scale(-1,1));f.translate(b.x,b.y);f.scale(b.scaleFactor,b.scaleFactor);f.translate(-b.x,-b.y);
f.translate(b.x,b.y);f.rotate(b.angle);f.translate(-b.x,-b.y);f.drawImage(a.Resources.entities02Image,r,r,c,c,d,k,2*b.radius,2*b.radius);a.drawNumber(f,g.toString(),d+b.radius,k+b.radius,.5*b.radius,2,!1);if(a.userData.levels[g-1]&&a.userData.levels[g-1].unlocked)switch(a.userData.levels[g-1].stars){case 0:f.drawImage(a.Resources.entities02Image,p,q,c,e,d,k+b.radius,2*b.radius,1*b.radius);break;case 1:f.drawImage(a.Resources.entities02Image,c,r,c,e,d,k+b.radius,2*b.radius,1*b.radius);break;case 2:f.drawImage(a.Resources.entities02Image,
c,q,c,e,d,k+b.radius,2*b.radius,1*b.radius);break;case 3:f.drawImage(a.Resources.entities02Image,p,r,c,e,d,k+b.radius,2*b.radius,1*b.radius)}else f.drawImage(a.Resources.hud01Image,r,u,e,e,d+b.radius,k+b.radius,b.radius,b.radius);f.restore()};a.drawHint=function(f,b,l){l=b.x-b.radius;var g=b.y-b.radius,h=0;switch(b.type){case a.ObjectTypeEnum.Block:h=k;break;case a.ObjectTypeEnum.Green:h=d;break;case a.ObjectTypeEnum.Red:h=e;break;case a.ObjectTypeEnum.Yellow:h=c;break;case a.ObjectTypeEnum.Purple:h=
p}f.save();b.direction===a.DirectionEnum.Right&&(f.translate(2*b.x,0),f.scale(-1,1));f.translate(b.x,b.y);f.scale(b.scaleFactor,b.scaleFactor);f.translate(-b.x,-b.y);f.translate(b.x,b.y);f.rotate(b.angle);f.translate(-b.x,-b.y);f.drawImage(a.Resources.entities01Image,k,d+h,e,e,l,g,2*b.radius,2*b.radius);f.restore()};a.drawObject=function(c,b,l,g){l=b.x-b.radius;var k=b.y-b.radius;c.save();b.direction===a.DirectionEnum.Right&&(c.translate(2*b.x,0),c.scale(-1,1));c.translate(b.dragOffsetX,b.dragOffsetY);
c.translate(b.x,b.y);c.scale(b.scaleFactor,b.scaleFactor);c.translate(-b.x,-b.y);c.translate(b.x,b.y);c.rotate(b.angle);c.translate(-b.x,-b.y);!b.moving&&b.type!==a.ObjectTypeEnum.None&&b.type!==a.ObjectTypeEnum.Block&&g&&(g=1===b.heartBeats[2].direction?.5*b.heartBeats[2].time*b.radius:0,c.drawImage(a.Resources.entities01Image,r,e,e,e,l-.75*b.radius,k+.8*b.radius+.7*g,2*b.radius,2*b.radius),0===b.heartBeats[1].direction?c.drawImage(a.Resources.entities01Image,q,d,e,e,l,k-g,2*b.radius,2*b.radius):
c.drawImage(a.Resources.entities01Image,q,e,e,e,l,k-g,2*b.radius,2*b.radius),g=.15*b.heartBeats[0].time,c.globalAlpha=.4*b.heartBeats[0].time+.3,c.drawImage(a.Resources.entities01Image,r,d,e,e,l-g,k-g,2*b.radius+2*g,2*b.radius+2*g),c.globalAlpha=1);if(b.segments)for(l=0;l<b.segments.length;l+=1)c.strokeStyle="rgb(255, 0, 0)",c.save(),c.restore();c.restore()};a.drawPolygonLimits=function(a,b,c){var d,e;d=b.vertices[b.vertices.length-1].x;e=b.vertices[b.vertices.length-1].y;a.beginPath();a.moveTo(d,
e);for(d=0;d<b.vertices.length;d+=1)e=b.vertices[d],a.lineTo(e.x,e.y);a.closePath();a.fillStyle=c;a.fill()};a.drawPolygonOutline=function(f,b,l){var g,h,n=0,q=.06*(b.heartBeats[n].time-.5*b.heartBeats[n].maxTime);h=b.outlineVertices[b.outlineVertices.length-2];var r=b.outlineVertices[b.outlineVertices.length-1],t=h.x+q,u=h.y+q,x=0;switch(b.object.type){case a.ObjectTypeEnum.Block:x=k;break;case a.ObjectTypeEnum.Green:x=d;break;case a.ObjectTypeEnum.Red:x=e;break;case a.ObjectTypeEnum.Yellow:x=c;break;
case a.ObjectTypeEnum.Purple:x=p}f.beginPath();f.moveTo(t,u);for(g=0;g<b.outlineVertices.length;g+=1)if(h=b.outlineVertices[g],1===h.quad)f.lineTo(h.x+q,h.y+q);else if(2===h.quad)r=h;else if(3===h.quad){f.quadraticCurveTo(r.x+q,r.y+q,h.x+q,h.y+q);if(g===b.outlineVertices.length-3)break;q=.06*(b.heartBeats[++n].time-.5*b.heartBeats[n].maxTime);1<n&&(n=-1)}f.lineTo(t,u);f.closePath();f.lineWidth=0===l.currentLevel&&0===l.percentDone&&4===b.object.group?1===a.getTitleHeartbeat3().direction?.05*l.unit:
.1*l.unit:.05*l.unit;f.strokeStyle="rgb(0, 0, 0)";f.stroke();f.clip();f.drawImage(a.Resources.entities01Image,c,d+x,e,e,l.minX-2*l.margin,l.minY-2*l.margin,l.width+4*l.margin,l.height+4*+l.margin)};a.drawPolygonBody=function(f,b,l){var g,h,n=0,q=.06*(b.heartBeats[n].time-.5*b.heartBeats[n].maxTime);h=b.outlineVertices[b.outlineVertices.length-2];var r=b.outlineVertices[b.outlineVertices.length-1],t=h.cx+q,u=h.cy+q,x=0;switch(b.object.type){case a.ObjectTypeEnum.Block:x=k;break;case a.ObjectTypeEnum.Green:x=
d;break;case a.ObjectTypeEnum.Red:x=e;break;case a.ObjectTypeEnum.Yellow:x=c;break;case a.ObjectTypeEnum.Purple:x=p}f.beginPath();f.moveTo(t,u);for(g=0;g<b.outlineVertices.length;g+=1)if(h=b.outlineVertices[g],1===h.quad)f.lineTo(h.cx+q,h.cy+q);else if(2===h.quad)r=h;else if(3===h.quad){f.quadraticCurveTo(r.cx+q,r.cy+q,h.cx+q,h.cy+q);if(g===b.outlineVertices.length-3)break;q=.06*(b.heartBeats[++n].time-.5*b.heartBeats[n].maxTime);1<n&&(n=-1)}f.lineTo(t,u);f.closePath();f.clip();f.drawImage(a.Resources.entities01Image,
e,d+x,e,e,l.minX-2*l.margin,l.minY-2*l.margin,l.width+4*l.margin,l.height+4*+l.margin)};a.drawPolygonHighlight=function(f,b,l){var g,h,n=0,q=.15*(b.heartBeats[n].time-.5*b.heartBeats[n].maxTime);h=b.outlineVertices[b.outlineVertices.length-2];var r=b.outlineVertices[b.outlineVertices.length-1],t=h.bx+q,u=h.by+q,x=0;switch(b.object.type){case a.ObjectTypeEnum.Block:x=k;break;case a.ObjectTypeEnum.Green:x=d;break;case a.ObjectTypeEnum.Red:x=e;break;case a.ObjectTypeEnum.Yellow:x=c;break;case a.ObjectTypeEnum.Purple:x=
p}f.beginPath();f.moveTo(t,u);for(g=0;g<b.outlineVertices.length;g+=1)if(h=b.outlineVertices[g],1===h.quad)f.lineTo(h.bx+q,h.by+q);else if(2===h.quad)r=h;else if(3===h.quad){f.quadraticCurveTo(r.bx+q,r.by+q,h.bx+q,h.by+q);if(g===b.outlineVertices.length-3)break;q=.15*(b.heartBeats[++n].time-.5*b.heartBeats[n].maxTime);1<n&&(n=-1)}f.lineTo(t,u);f.closePath();f.clip();f.drawImage(a.Resources.entities01Image,d,d+x,e,e,l.minX-2*l.margin,l.minY-2*l.margin,l.width+4*l.margin,l.height+4*+l.margin)};a.drawEffect=
function(c,b,d){c.save();b.direction===a.DirectionEnum.Left&&(c.translate(2*b.x,0),c.scale(-1,1));c.translate(b.x,b.y);0<=b.scaleTime?c.scale(b.scaleFactor+b.scaleTime,b.scaleFactor+b.scaleTime):c.scale(b.scaleFactor,b.scaleFactor);c.translate(-b.x,-b.y);c.translate(b.x,b.y);c.rotate(b.angle);c.translate(-b.x,-b.y);b.selfDestroyTime<b.startFadeTime&&(c.globalAlpha=b.selfDestroyTime);switch(b.type){case a.EffectTypeEnum.SparkEffect:c.drawImage(a.Resources.loadingScreenImage,u+b.displayOffset*e,q,e,
e,b.x-.5,b.y-.5,1,1);break;case a.EffectTypeEnum.NumberEffect:a.drawNumber(c,b.number.toString(),b.x-.5,b.y-.5,1.3,b.color,b.hasX)}c.restore()}})(window.OkijinGame=window.OkijinGame||{});(function(a,D){function d(){U=7;V=5.3;Y=1;Z=.5;aa=.1;H=L=I=0;Q=a.DirectionEnum.Left}function e(){var b;G=a.GameStateEnum.GameLoading;var d=[{type:"img",id:"background1",src:v.root+"/assets/img/"+h+"/background1.png"},{type:"img",id:"entities1",src:v.root+"/assets/img/"+h+"/entities1.png"},{type:"img",id:"entities2",src:v.root+"/assets/img/"+h+"/entities2.png"},{type:"img",id:"entities3",src:v.root+"/assets/img/"+h+"/entities3.png"},{type:"img",id:"hud1",src:v.root+"/assets/img/"+h+"/hud1.png"}];if(a.preloadSounds)for(b in a.soundItems)a.soundItems.hasOwnProperty(b)&&
d.push({type:"snd",id:b,src:v.root+"/"+a.soundItems[b]});a.loadResources(d,k,c)}function c(a,b){W={current:a,total:b};v.onGameLoading(Math.ceil(100*a/b))}function k(b){a.Resources.hud01Image=b.hud1;a.Resources.background01Image=b.background1;a.Resources.entities01Image=b.entities1;a.Resources.entities02Image=b.entities2;a.Resources.entities03Image=b.entities3;X=!0}function p(){var b=(new Date).getTime(),c=Math.min((b-(ba||b))/1E3,.05),d=c;ba=b;window.requestAnimationFrame(p);x.setTransform(1,0,0,
1,0,0);x.clearRect(0,0,y.width,y.height);0<M&&(c*=.5);var b=c,e,f;if(X)if(G===a.GameStateEnum.GameLoading)G=a.GameStateEnum.GameRun,m=new a.SceneManager,m.size=a.screenToHud({x:y.width,y:y.height}),R=!1,m.showMenu=!0,l(),r(),G=a.GameStateEnum.GameRun,a.playSound("slash");else if(G===a.GameStateEnum.GameRun){c=0;for(e=B.length;c<e;c+=1)f=B[c],0===f.direction&&f.time<=f.maxTime?(f.time=Math.min(f.time+b*f.speed1,f.maxTime),f.time===f.maxTime&&(f.direction=1)):1===f.direction&&0<=f.time&&(f.time=Math.max(f.time-
b*f.speed2,0),0===f.time&&(f.direction=0));m.update(b);f=[];for(c=0;c<m.effects.length;)if(e=m.effects[c],e.update(b),0===e.selfDestroyTime)m.effects.splice(c,1);else{if(e.target){var g=e.target.x,k=e.target.y,h=a.distance(e.x,e.y,g,k);h>e.radius?(e.vx=(g-e.x)/h*e.speed,e.vy=(k-e.y)/h*e.speed):e.selfDestroyTime=0}c+=1}for(c=0;c<f.length;c+=1)m.effects.push(f[c]);c=n();m.shakeCamera&&(m.shakeCamera=!1,H=.2,Q=Q===a.DirectionEnum.Right?a.DirectionEnum.Left:a.DirectionEnum.Right);m.slowCamera&&(m.slowCamera=
!1,M=3);m.zoomCamera&&(m.zoomCamera=!1,I=1.3);J=0;E=c.zoom;g=S={x:m.minX+.5*m.width,y:m.minY+.5*m.height};c=A.x;e=A.y;A.x=0;A.y=0;A.update();0<M&&(M-=d,0>M&&(M=0));f=new a.Camera;f.multiply(F);f=f.screenToCamera(y.width,y.height);A.tx=f.x/2-g.x;A.ty=f.y/2-g.y;g=a.distance(c,e,A.tx,A.ty);1E-4<Math.abs(g)?(k=(A.ty-e)/g,h=b*g*U,c+=(A.tx-c)/g*g*U*1*b,e+=h*k):(c=A.tx,e=A.ty);A.x=c;A.y=e;w.x=f.x/2-c;w.y=f.y/2-e;0<H&&(H-=b,0>H&&(H=0));0<I&&(I-=b,0>I&&(I=0));0<L&&(L-=b,0>L&&(L=0));b=Y;0<I&&(E*=.6,b=Z);0<
L&&(b=aa);w.sx>E&&(w.sx-=b*d,w.sx<E&&(w.sx=E));w.sx<E&&(w.sx+=b*d,w.sx>E&&(w.sx=E));w.sy=w.sx;0===H&&(w.angle>J?(w.angle-=V*Math.PI*d,w.angle<J&&(w.angle=J)):w.angle<J&&(w.angle+=V*Math.PI*d,w.angle>J&&(w.angle=J)));0<H&&(w.angle=Q===a.DirectionEnum.Right?-.05+.25*B[0].time:.05-.25*B[0].time);A.update();w.update();N.update()}a.draw(x,m)}function n(){var b,c,e;b=new a.Camera;var d=m.maxY-m.minY,f=m.maxX-m.minX,g=.22>Math.abs(1-y.height/y.width)?5.5*m.hudUnit:2.5*m.hudUnit;b.multiply(F);b=b.screenToCamera(y.width,
y.height);switch(C){case a.LayoutOrientationEnum.Landscape:e=b.y/(d+.5*g);c=b.x/(f+g);break;case a.LayoutOrientationEnum.Portrait:e=b.y/(d+g),c=b.x/(f+.5*g)}return{x:m.minX+.5*f,y:m.minY+.5*d,zoom:Math.min(1*c,1*e)}}function u(b,c,e){var d=a.DirectionEnum.None,f=c.pointerEndPos.x-c.pointerStartPos.x,g=c.pointerEndPos.y-c.pointerStartPos.y,d=Math.abs(f)>Math.abs(g)?0>f?a.DirectionEnum.Left:a.DirectionEnum.Right:0>g?a.DirectionEnum.Top:a.DirectionEnum.Bottom;b=c.groups[c.dragObject.group];var k=c.getGroupMovementMagnitude(b,
d);if(0<k&&b.length){for(var l=!1,m=b[0].type,h=0;h<b.length;h+=1){b[h].dragDirection=d;var n=b[h].radius,p=.5*n;switch(b[h].dragDirection){case a.DirectionEnum.Left:b[h].dragOffsetX=Math.max(-p,f*n*10);break;case a.DirectionEnum.Right:b[h].dragOffsetX=Math.min(p,f*n*10);break;case a.DirectionEnum.Top:b[h].dragOffsetY=Math.max(-p,g*n*10);break;case a.DirectionEnum.Bottom:b[h].dragOffsetY=Math.min(p,g*n*10)}if(Math.abs(b[h].dragOffsetX)>.7*p||Math.abs(b[h].dragOffsetY)>.7*p)l=e}if(l){e={objects:[]};
for(h=0;h<c.grid.size;++h)for(e.objects.push([]),d=0;d<c.grid.size;++d)e.objects[h][d]=c.objects[h][d].type;c.previousGrids[c.previousGrids.length]=e;e=[];for(h=0;h<b.length;h+=1){d=b[h].column;f=b[h].row;switch(b[h].dragDirection){case a.DirectionEnum.Left:d-=k;break;case a.DirectionEnum.Right:d+=k;break;case a.DirectionEnum.Top:f-=k;break;case a.DirectionEnum.Bottom:f+=k}c.objects[f][d].x=b[h].tx+b[h].dragOffsetX;c.objects[f][d].y=b[h].ty+b[h].dragOffsetY;e.push(c.objects[f][d]);b[h].type=a.ObjectTypeEnum.None;
b[h].dragDirection=a.DirectionEnum.None;b[h].selected=!1;b[h].dragOffsetX=0;b[h].dragOffsetY=0}for(h=0;h<c.polygons.length;h+=1)if(c.polygons[h].object.group===b[0].group){c.polygons[h].object=e[0];break}for(h=0;h<e.length;h+=1)e[h].type=m;c.resetGroups=!0;c.dragObject=null;0===c.currentLevel&&(B[3].direction=1,B[3].time=B[3].maxTime,c.tutorialStep++);a.playSound("touch")}}}function t(){for(var a=0;a<m.levelObjects.length;a+=1)m.levelObjects[a].x+=5*m.levelObjects[a].radius*Math.random()*5*(.5<Math.random()?
-1:1),m.levelObjects[a].y+=5*m.levelObjects[a].radius*Math.random()*5*(.5<Math.random()?-1:1)}function r(){for(var a=0;a<m.letters.length;++a)m.letters[a].x+=2*m.hudUnit*Math.random()*2*(.5<Math.random()?-1:1),m.letters[a].y+=2*m.hudUnit*Math.random()*2*(.5<Math.random()?-1:1)}function q(b){var c,e;O=!0;c=b.pageX;e=b.pageY;b=a.screenToScene({x:c/z,y:e/K});c=a.screenToHud({x:c/z,y:e/K});a.screenToHud({x:y.width,y:y.height});if(G===a.GameStateEnum.GameRun){m.pointerStartPos=a.screenToScene({x:b.x,y:b.y});
m.pointerEndPos=a.screenToScene({x:b.x,y:b.y});m.dragObject=null;e=e=T=P=!1;if(m.showOptions&&!m.showOptionsTime){var d=m.homeButton;a.pointInRect(c.x,c.y,d.x-d.radius,d.y-d.radius,d.x+d.radius,d.y+d.radius)&&(e=m.showMenu=!0,r(),a.playSound("click"));d=m.levelsButton;a.pointInRect(c.x,c.y,d.x-d.radius,d.y-d.radius,d.x+d.radius,d.y+d.radius)&&(e=m.showLevels=!0,t(),a.playSound("click"));m.showOptions=!1;m.showOptionsTime=.5;T=!0}if(!e&&m.showLevels)if(m.showMenu=!1,d=m.menuButton,a.pointInRect(c.x,
c.y,d.x-d.radius,d.y-d.radius,d.x+d.radius,d.y+d.radius))m.showLevels=!1,m.showMenu=!0,r(),a.playSound("click");else{var f=!1,g=[m.pack1Button,m.pack2Button,m.pack3Button,m.pack4Button];for(e=0;e<g.length;e+=1)if(g[e]&&(d=g[e],a.pointInRect(c.x,c.y,d.x-d.radius,d.y-d.radius,d.x+d.radius,d.y+d.radius))){f=!0;t();m.startIndex=25*e;a.playSound("click");break}if(!f){c=m.startIndex;for(e=0;e<m.levelObjects.length;e+=1){d=m.levelObjects[e];if(a.pointInRect(b.x,b.y,d.x-d.radius,d.y-d.radius,d.x+d.radius,
d.y+d.radius))break;c++}a.devMode||a.userData.levels[c]&&a.userData.levels[c].unlocked?m.levelObjects.length>c-m.startIndex&&(m.showLevels=!1,m.currentLevel=c,a.userData.packIndex=m.startIndex,a.userData.levelIndex=m.currentLevel,a.saveUserData(),l()):a.playSound("locked")}}else if(!e&&m.showMenu)a.pointInRect(c.x,c.y,0,0,.5*m.hudUnit,.5*m.hudUnit)?(a.playSound("click"),a.enableSound(!a.isSoundEnabled)):(m.showMenu=!1,m.showLevels=!0,l(),t()),a.playSound("click");else if(!(e||m.showHintDialog||m.showBadHintDialog||
m.showStartDialog)){e=m;d=!1;f=e.resetButton;e.levelWon||e.levelLost||e.showHint||(f.clicked=!1,a.pointInRect(c.x,c.y,f.x-f.radius,f.y-f.radius,f.x+f.radius,f.y+f.radius)&&(d=!0,f.clicked=!0),f=e.undoButton,f.clicked=!1,a.pointInRect(c.x,c.y,f.x-f.radius,f.y-f.radius,f.x+f.radius,f.y+f.radius)&&(d=!0,f.clicked=!0),f=e.hintButton,f.clicked=!1,a.pointInRect(c.x,c.y,f.x-f.radius,f.y-f.radius,f.x+f.radius,f.y+f.radius)&&(d=!0,f.clicked=!0),f=e.menuButton,f.clicked=!1,a.pointInRect(c.x,c.y,f.x-f.radius,
f.y-f.radius,f.x+f.radius,f.y+f.radius)&&(d=!0,f.clicked=!0));e=d;m.showHint&&(P=!0,m.showHint=!1,m.showHintTime=.5,e=!0,a.playSound("slash"));m.canProcessLevelEnded=!1;if(m.levelWon||m.levelLost)e=!0,m.canProcessLevelEnded=!0;if(!e)for(e=0;e<m.grid.size;++e)for(c=0;c<m.grid.size;++c)if(d=m.objects[e][c],d.type!==a.ObjectTypeEnum.Block&&(0<m.currentLevel||0===m.percentDone&&4===d.group||0<m.percentDone)&&a.pointInRect(b.x,b.y,d.x-d.radius,d.y-d.radius,d.x+d.radius,d.y+d.radius)){m.dragObject=d;d=
m.groups[d.group];for(c=0;c<d.length;c+=1)d[c].selected=!0;break}}}}function f(b){var c,d;c=b.pageX;d=b.pageY;b=a.screenToScene({x:c/z,y:d/K});c=a.screenToHud({x:c/z,y:d/K});a.screenToHud({x:y.width,y:y.height});G!==a.GameStateEnum.GameRun||!O||m.showBadHintDialog||m.showStartDialog||m.showHintDialog||m.showMenu||m.showLevels||(m.pointerEndPos=a.screenToScene({x:b.x,y:b.y}),m.dragObject&&u(c,m,!0))}function b(b){var c;c=b.pageX;b=b.pageY;a.screenToScene({x:c/z,y:b/K});c=a.screenToHud({x:c/z,y:b/K});
a.screenToHud({x:y.width,y:y.height});if(G===a.GameStateEnum.GameRun&&O)if(O=!1,m.canProcessLevelEnded&&(m.levelWon||m.levelLost))m.modalTime||(b=m.okButton,m.levelLost?a.pointInRect(c.x,c.y,b.x-b.radius,b.y-b.radius,b.x+b.radius,b.y+b.radius)&&(m.showLevels=!0,l(),t(),a.playSound("click")):a.pointInRect(c.x,c.y,b.x-b.radius,b.y-b.radius,b.x+b.radius,b.y+b.radius)&&(m.currentLevel+=1,m.currentLevel<m.maxLevels?(m.currentLevel>=m.startIndex+25&&(m.startIndex+=25),a.userData.packIndex=m.startIndex,
a.userData.levelIndex=m.currentLevel,a.saveUserData()):(m.showLevels=!0,t()),l(),a.playSound("click")),b=m.retryButton,a.pointInRect(c.x,c.y,b.x-b.radius,b.y-b.radius,b.x+b.radius,b.y+b.radius)&&(l(),a.playSound("click")));else if(m.showBadHintDialog)m.modalTime||(m.showBadHintDialog=!1);else if(m.showStartDialog)m.modalTime||(m.showStartDialog=!1);else if(m.showHintDialog){if(!m.modalTime&&(m.showHintDialog=!1,b=m.okButton,a.pointInRect(c.x,c.y,b.x-b.radius,b.y-b.radius,b.x+b.radius,b.y+b.radius))){a.userData.gold-=
m.hintCost;a.userData.levels[m.currentLevel].hint=1;a.saveUserData();m.showHint=!m.showHint;m.showHintTime=.5;var d=m.width/m.grid.size;for(c=0;c<m.grid.size;++c)for(b=0;b<m.grid.size;++b)m.hints[c][b].x+=5*d*Math.random()*5*(.5<Math.random()?-1:1),m.hints[c][b].y+=5*d*Math.random()*5*(.5<Math.random()?-1:1);a.playSound("tip")}}else{if(!m.dragObject){b=m;d=b.resetButton;d.clicked&&a.pointInRect(c.x,c.y,d.x-d.radius,d.y-d.radius,d.x+d.radius,d.y+d.radius)&&(l(!0),a.playSound("click"));d.clicked=!1;
d=b.menuButton;!T&&!b.showOptionsTime&&d.clicked&&a.pointInRect(c.x,c.y,d.x-d.radius,d.y-d.radius,d.x+d.radius,d.y+d.radius)&&(b.showOptions=!b.showOptions,b.showOptionsTime=.5,a.playSound("click"));d.clicked=!1;d=b.undoButton;if(d.clicked&&a.pointInRect(c.x,c.y,d.x-d.radius,d.y-d.radius,d.x+d.radius,d.y+d.radius)&&b.previousGrids.length){var e=b.previousGrids[b.previousGrids.length-1];b.objects=[];for(var f=b.width/b.grid.size,g=0;g<b.grid.size;++g){b.objects.push([]);for(var h=0;h<b.grid.size;++h)b.objects[g][h]=
new a.ObjectEntity(e.objects[g][h],b.minX+h*f+.5*f,b.minY+g*f+.5*f,g,h,.5*f)}b.previousGrids.splice(b.previousGrids.length-1,1);b.resetGroups=!0;b.moves+=1;b.moveTime=.3;a.playSound("undo")}d.clicked=!1;d=b.hintButton;if(!P&&d.clicked&&a.pointInRect(c.x,c.y,d.x-d.radius,d.y-d.radius,d.x+d.radius,d.y+d.radius))if(a.userData.levels[b.currentLevel].hint){b.showHint=!b.showHint;b.showHintTime=.5;f=b.width/b.grid.size;for(g=0;g<b.grid.size;++g)for(h=0;h<b.grid.size;++h)b.hints[g][h].x+=5*f*Math.random()*
5*(.5<Math.random()?-1:1),b.hints[g][h].y+=5*f*Math.random()*5*(.5<Math.random()?-1:1);a.playSound("tip")}else a.userData.gold>=b.hintCost?(b.showHintDialog=!0,b.modalTime=.5,a.playSound("alert")):(b.showBadHintDialog=!0,b.modalTime=.5,a.playSound("badclick"));d.clicked=!1}m.dragObject&&u(c,m,!0);if(m.dragObject){b=m.groups[m.dragObject.group];for(c=0;c<b.length;c+=1)b[c].selected=!1,b[c].dragDirection=a.DirectionEnum.None;m.dragObject=null}}P=!1}function l(b){var c;d();m.loadLevel();m.resize();J=
0;S={x:.5*m.width,y:.5*m.height};E=n().zoom;c=new a.Camera;c.multiply(F);c=c.screenToCamera(y.width,y.height);A.x=c.x/2-S.x;A.y=c.y/2-S.y;w.angle=0;w.sx=E;w.sy=E;v.onGameSessionStarted(m.currentLevel+1);m.showLevels||a.playSound("slide");!b&&1<m.currentLevel&&(m.showStartDialog=!0,m.modalTime=.5)}var g,h,v,C,z,K,y,x,R,G,ba,m,F,A,w,N,S,E,U,V,Y,Z,aa,J,I,L,H,Q,M,X,W,P,T,O,B=[{time:0,direction:0,maxTime:.2,speed1:3,speed2:3},{time:0,direction:0,maxTime:.5,speed1:1,speed2:1.5},{time:0,direction:0,maxTime:.3,
speed1:2,speed2:2},{time:0,direction:0,maxTime:1,speed1:1.5,speed2:3.5},{time:0,direction:0,maxTime:2,speed1:1.5,speed2:2},{time:0,direction:0,maxTime:1,speed1:3,speed2:2},{time:0,direction:0,maxTime:1,speed1:2.5,speed2:1},{time:0,direction:0,maxTime:2,speed1:5,speed2:2.5},{time:0,direction:0,maxTime:1,speed1:1.5,speed2:1.2},{time:0,direction:0,maxTime:1,speed1:4,speed2:3}];a.getScaleUnit=function(){return g};a.getCurrentGameState=function(){return G};a.getCanvasWidth=function(){return y.width};a.getCanvasHeight=
function(){return y.height};a.getGameLoadingData=function(){return W};a.getLayoutOrientation=function(){return C};a.getTitleHeartbeat1=function(){return B[1]};a.getTitleHeartbeat2=function(){return B[2]};a.getTitleHeartbeat3=function(){return B[3]};a.getTitleHeartbeat4=function(){return B[4]};a.getTitleHeartbeat5=function(){return B[5]};a.getTitleHeartbeat6=function(){return B[6]};a.getTitleHeartbeat7=function(){return B[7]};a.getTitleHeartbeat8=function(){return B[8]};a.getTitleHeartbeat9=function(){return B[9]};
a.getPaused=function(){return R};a.setPaused=function(a){R=a};a.applyHudCameras=function(){x.setTransform.apply(x,F.matrix);x.transform.apply(x,N.matrix)};a.applySceneCameras=function(){x.setTransform.apply(x,F.matrix);x.transform.apply(x,A.matrix);x.transform.apply(x,w.matrix)};a.applyVeryFarParallaxCameras=function(){x.translate(.15*-w.x,.15*-w.y)};a.applyFarParallaxCameras=function(){x.translate(.4*-w.x,.4*-w.y)};a.applyNearParallaxCameras=function(){x.translate(.65*-w.x,.65*-w.y)};a.applyHereParallaxCameras=
function(){x.translate(-w.x,-w.y)};a.screenToHud=function(b){var c=new a.Camera;c.multiply(F);c.multiply(N);return c.screenToCamera(b.x,b.y)};a.screenToScene=function(b){var c=new a.Camera;c.multiply(F);c.multiply(A);c.multiply(w);c.translate(-w.x,-w.y);return c.screenToCamera(b.x,b.y)};a.getAssetResolution=function(){return a.AssetResolutionEnum.ResolutionA};a.initialize=function(c){a.initializeSystem();d();v={root:c&&c.root?c.root:"",onGameLoading:c&&c.onGameLoading?c.onGameLoading:function(){},
onGameSessionStarted:c&&c.onGameSessionStarted?c.onGameSessionStarted:function(){},onGameSessionEnded:c&&c.onGameSessionEnded?c.onGameSessionEnded:function(){},useHighResolution:c&&c.useHighResolution?c.useHighResolution:!1,rollTime:c&&c.rollTime?c.rollTime:0};O=X=R=!1;W={current:0,total:0};T=P=!1;c=a.AssetResolutionEnum.ResolutionA;if(!v.useHighResolution){var k=Math.max($(window).width(),$(window).height());c=a.AssetResolutionEnum.ResolutionB;400>k?c=a.AssetResolutionEnum.ResolutionE:500>k?c=a.AssetResolutionEnum.ResolutionD:
1E3>k&&(c=a.AssetResolutionEnum.ResolutionC)}a.devMode&&(c=a.AssetResolutionEnum.ResolutionDev);switch(c){case a.AssetResolutionEnum.ResolutionDev:g=.0078125;h="1280";break;case a.AssetResolutionEnum.ResolutionA:g=1/96;h="960";break;case a.AssetResolutionEnum.ResolutionB:g=1/72;h="720";break;case a.AssetResolutionEnum.ResolutionC:g=1/65;h="650";break;case a.AssetResolutionEnum.ResolutionD:g=.025;h="400";break;case a.AssetResolutionEnum.ResolutionE:g=.03125,h="320"}a.initializeLevels();a.loadUserData();
a.setupTileOffsets();y=document.getElementById("canvas");x=y.getContext("2d");$(document).bind("vmousedown",q);$(document).bind("vmouseup",b);$(document).bind("vmousemove",f);F=new a.Camera;A=new a.Camera;w=new a.Camera;N=new a.Camera;N.sx=1;N.sy=1;N.update();a.resetDisplay();a.Resources.loadingScreenImage=new Image;a.Resources.loadingScreenImage.onload=e;a.Resources.loadingScreenImage.src=v.root+"/assets/img/"+h+"/loadingscreen.png";G=a.GameStateEnum.GamePreLoading;p()};a.resetDisplay=function(){var b=
1/g;C=$(window).width()>=$(window).height()?a.LayoutOrientationEnum.Landscape:a.LayoutOrientationEnum.Portrait;y.width=C===a.LayoutOrientationEnum.Landscape?14*b:8*b;y.height=C===a.LayoutOrientationEnum.Landscape?14*b*$(window).height()/$(window).width():8*b*$(window).height()/$(window).width();z=$(window).width()/y.width;K=$(window).height()/y.height;y.style.width=$(window).width()+"px";y.style.height=$(window).height()+"px";F&&(F.sx=1/g,F.sy=1/g,F.update());m&&m.resize({x:y.width,y:y.height})}})(window.OkijinGame=
window.OkijinGame||{});
